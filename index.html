<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 14: SOC Level 1 Capstone Challenges | CVNP 2625</title>
    <style>
        :root {
            --primary-red: #dc2626;
            --dark-red: #991b1b;
            --light-red: #fecaca;
            --black: #0a0a0a;
            --dark-gray: #1a1a1a;
            --medium-gray: #2d2d2d;
            --light-gray: #404040;
            --text-gray: #e5e5e5;
            --muted-gray: #a3a3a3;
            --success: #22c55e;
            --warning: #f59e0b;
            --info: #3b82f6;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'IBM Plex Sans', -apple-system, sans-serif; background: var(--black); color: var(--text-gray); line-height: 1.7; }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        header { background: linear-gradient(135deg, var(--dark-gray), var(--black)); border-bottom: 3px solid var(--primary-red); padding: 2rem 0; margin-bottom: 2rem; }
        .header-content { max-width: 1400px; margin: 0 auto; padding: 0 2rem; }
        .week-badge { display: inline-block; background: var(--primary-red); color: white; padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 600; border-radius: 4px; margin-bottom: 1rem; font-family: 'JetBrains Mono', monospace; }
        .capstone-badge { display: inline-block; background: linear-gradient(135deg, var(--primary-red), #f59e0b); color: white; padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 600; border-radius: 4px; margin-left: 0.5rem; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        h1 { font-size: 2.5rem; font-weight: 700; color: white; margin-bottom: 0.5rem; }
        h1 .highlight { color: var(--primary-red); }
        .subtitle { color: var(--muted-gray); font-size: 1.1rem; }
        .progress-container { background: var(--dark-gray); border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem; border: 1px solid var(--medium-gray); }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .progress-title { font-weight: 600; color: white; }
        .progress-stats { font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; color: var(--muted-gray); }
        .progress-bar { height: 12px; background: var(--medium-gray); border-radius: 6px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--primary-red), var(--warning)); border-radius: 6px; transition: width 0.5s ease; width: 0%; }
        nav { background: var(--dark-gray); border-radius: 8px; padding: 1rem; margin-bottom: 2rem; border: 1px solid var(--medium-gray); }
        .nav-list { display: flex; flex-wrap: wrap; gap: 0.5rem; list-style: none; }
        .nav-item { flex: 1; min-width: 150px; }
        .nav-link { display: block; padding: 0.75rem 1rem; background: var(--medium-gray); color: var(--text-gray); text-decoration: none; border-radius: 6px; font-size: 0.875rem; text-align: center; transition: all 0.3s ease; border: 1px solid transparent; }
        .nav-link:hover { background: var(--light-gray); border-color: var(--primary-red); }
        .nav-link.active { background: var(--primary-red); color: white; }
        .nav-link.completed { border-color: var(--success); }
        .nav-link.completed::after { content: ' ‚úì'; color: var(--success); }
        section { background: var(--dark-gray); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; border: 1px solid var(--medium-gray); display: none; }
        section.active { display: block; }
        .section-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid var(--primary-red); }
        .section-number { background: var(--primary-red); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.25rem; }
        h2 { font-size: 1.75rem; color: white; }
        h3 { font-size: 1.25rem; color: var(--primary-red); margin: 2rem 0 1rem; }
        h4 { font-size: 1.1rem; color: white; margin: 1.5rem 0 0.75rem; }
        p { margin-bottom: 1rem; }
        .info-box, .warning-box, .success-box, .critical-box { padding: 1.25rem; border-radius: 0 8px 8px 0; margin: 1.5rem 0; }
        .info-box { background: rgba(59, 130, 246, 0.1); border-left: 4px solid var(--info); }
        .warning-box { background: rgba(245, 158, 11, 0.1); border-left: 4px solid var(--warning); }
        .success-box { background: rgba(34, 197, 94, 0.1); border-left: 4px solid var(--success); }
        .critical-box { background: rgba(220, 38, 38, 0.1); border-left: 4px solid var(--primary-red); }
        .box-title { font-weight: 600; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
        code { font-family: 'JetBrains Mono', monospace; background: var(--medium-gray); padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.9rem; color: var(--light-red); }
        pre { background: var(--black); border: 1px solid var(--medium-gray); border-radius: 8px; padding: 1.25rem; overflow-x: auto; margin: 1rem 0; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; line-height: 1.6; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.9rem; }
        th, td { padding: 1rem; text-align: left; border: 1px solid var(--medium-gray); }
        th { background: var(--primary-red); color: white; font-weight: 600; }
        tr:nth-child(even) { background: var(--medium-gray); }
        tr:hover { background: var(--light-gray); }
        ul, ol { margin: 1rem 0 1rem 2rem; }
        li { margin-bottom: 0.5rem; }
        .exercise-container { background: var(--black); border: 2px solid var(--primary-red); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; }
        .exercise-header { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; }
        .exercise-icon { background: var(--primary-red); width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; }
        .exercise-title { font-weight: 600; color: white; font-size: 1.1rem; }
        .quiz-question { background: var(--medium-gray); border-radius: 8px; padding: 1.25rem; margin: 1rem 0; }
        .question-text { font-weight: 500; margin-bottom: 1rem; color: white; }
        .quiz-options { display: flex; flex-direction: column; gap: 0.5rem; }
        .quiz-option { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: var(--dark-gray); border: 2px solid var(--light-gray); border-radius: 6px; cursor: pointer; transition: all 0.2s ease; }
        .quiz-option:hover { border-color: var(--primary-red); background: var(--light-gray); }
        .quiz-option.selected { border-color: var(--primary-red); background: rgba(220, 38, 38, 0.2); }
        .quiz-option.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.2); }
        .quiz-option.incorrect { border-color: var(--primary-red); background: rgba(220, 38, 38, 0.2); }
        .quiz-option input { display: none; }
        .option-indicator { width: 24px; height: 24px; border: 2px solid var(--muted-gray); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 600; }
        .quiz-option.selected .option-indicator { background: var(--primary-red); border-color: var(--primary-red); color: white; }
        .quiz-feedback { margin-top: 1rem; padding: 1rem; border-radius: 8px; display: none; }
        .quiz-feedback.show { display: block; }
        .quiz-feedback.correct { background: rgba(34, 197, 94, 0.2); border: 1px solid var(--success); color: var(--success); }
        .quiz-feedback.incorrect { background: rgba(220, 38, 38, 0.2); border: 1px solid var(--primary-red); color: var(--light-red); }
        .btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; border: none; font-size: 0.9rem; }
        .btn-primary { background: var(--primary-red); color: white; }
        .btn-primary:hover { background: var(--dark-red); }
        .btn-secondary { background: var(--medium-gray); color: var(--text-gray); border: 1px solid var(--light-gray); }
        .btn-secondary:hover { background: var(--light-gray); }
        .btn-group { display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap; }
        .timeline { position: relative; padding-left: 2rem; margin: 1.5rem 0; }
        .timeline::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background: var(--primary-red); }
        .timeline-item { position: relative; padding: 1rem 0 1rem 1.5rem; }
        .timeline-item::before { content: ''; position: absolute; left: -2rem; top: 1.25rem; width: 14px; height: 14px; background: var(--primary-red); border-radius: 50%; border: 3px solid var(--dark-gray); }
        .timeline-time { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: var(--primary-red); margin-bottom: 0.25rem; }
        .timeline-content { background: var(--medium-gray); padding: 1rem; border-radius: 8px; }
        .soc-workstation { background: var(--black); border: 2px solid var(--primary-red); border-radius: 12px; overflow: hidden; margin: 2rem 0; }
        .workstation-header { background: linear-gradient(135deg, var(--dark-red), var(--primary-red)); padding: 1rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
        .workstation-title { font-weight: 700; color: white; display: flex; align-items: center; gap: 0.75rem; }
        .workstation-status { display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; }
        .status-indicator { width: 10px; height: 10px; background: var(--success); border-radius: 50%; animation: blink 2s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .workstation-tabs { display: flex; background: var(--dark-gray); border-bottom: 1px solid var(--medium-gray); overflow-x: auto; }
        .workstation-tab { padding: 1rem 1.5rem; background: transparent; border: none; color: var(--muted-gray); cursor: pointer; font-weight: 500; font-size: 0.9rem; transition: all 0.2s ease; white-space: nowrap; display: flex; align-items: center; gap: 0.5rem; border-bottom: 3px solid transparent; }
        .workstation-tab:hover { background: var(--medium-gray); color: var(--text-gray); }
        .workstation-tab.active { color: white; background: var(--medium-gray); border-bottom-color: var(--primary-red); }
        .workstation-tab .badge { background: var(--primary-red); color: white; font-size: 0.7rem; padding: 0.15rem 0.5rem; border-radius: 10px; }
        .workstation-content { min-height: 500px; padding: 1.5rem; }
        .tool-panel { display: none; }
        .tool-panel.active { display: block; }
        .log-viewer { background: var(--black); border: 1px solid var(--medium-gray); border-radius: 8px; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; max-height: 400px; overflow-y: auto; }
        .log-header { background: var(--medium-gray); padding: 0.75rem 1rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--light-gray); position: sticky; top: 0; }
        .log-entry { padding: 0.5rem 1rem; border-bottom: 1px solid var(--medium-gray); cursor: pointer; transition: background 0.2s ease; }
        .log-entry:hover { background: var(--medium-gray); }
        .log-entry.suspicious { border-left: 3px solid var(--warning); }
        .log-entry.malicious { border-left: 3px solid var(--primary-red); }
        .log-timestamp { color: var(--muted-gray); }
        .log-source { color: var(--info); }
        .log-message { color: var(--text-gray); }
        .log-severity-critical { color: var(--primary-red); font-weight: 600; }
        .search-bar { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
        .search-input { flex: 1; padding: 0.75rem 1rem; background: var(--medium-gray); border: 1px solid var(--light-gray); border-radius: 6px; color: var(--text-gray); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; }
        .search-input:focus { outline: none; border-color: var(--primary-red); }
        .alert-card { background: var(--medium-gray); border-radius: 8px; padding: 1rem; margin: 0.5rem 0; border-left: 4px solid var(--warning); cursor: pointer; transition: all 0.2s ease; }
        .alert-card:hover { background: var(--light-gray); }
        .alert-card.critical { border-left-color: var(--primary-red); }
        .alert-card.high { border-left-color: #f97316; }
        .alert-card.medium { border-left-color: var(--warning); }
        .alert-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem; }
        .alert-title { font-weight: 600; color: white; }
        .alert-severity { font-size: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600; }
        .severity-critical { background: var(--primary-red); color: white; }
        .severity-high { background: #f97316; color: white; }
        .severity-medium { background: var(--warning); color: black; }
        .alert-meta { font-size: 0.8rem; color: var(--muted-gray); font-family: 'JetBrains Mono', monospace; }
        .process-tree { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; background: var(--black); border: 1px solid var(--medium-gray); border-radius: 8px; padding: 1rem; }
        .process-node { padding: 0.25rem 0; margin-left: 1.5rem; border-left: 1px dashed var(--light-gray); padding-left: 1rem; }
        .process-node:first-child { margin-left: 0; border-left: none; padding-left: 0; }
        .process-name { color: var(--info); }
        .process-suspicious { color: var(--warning); }
        .process-malicious { color: var(--primary-red); }
        .process-pid { color: var(--muted-gray); }
        .process-cmd { color: var(--text-gray); font-size: 0.8rem; margin-left: 1rem; }
        .report-section { background: var(--medium-gray); border-radius: 8px; padding: 1.5rem; margin: 1rem 0; }
        .report-section-title { font-weight: 600; color: white; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        .report-field { margin-bottom: 1rem; }
        .report-field label { display: block; font-weight: 500; margin-bottom: 0.5rem; color: var(--text-gray); }
        .report-field textarea, .report-field input, .report-field select { width: 100%; padding: 0.75rem; background: var(--dark-gray); border: 1px solid var(--light-gray); border-radius: 6px; color: var(--text-gray); font-family: inherit; font-size: 0.9rem; }
        .report-field textarea:focus, .report-field input:focus { outline: none; border-color: var(--primary-red); }
        .report-field textarea { min-height: 100px; resize: vertical; }
        .checklist { list-style: none; margin: 0; padding: 0; }
        .checklist-item { display: flex; align-items: flex-start; gap: 0.75rem; padding: 0.75rem; background: var(--dark-gray); border-radius: 6px; margin: 0.5rem 0; cursor: pointer; }
        .checklist-item:hover { background: var(--medium-gray); }
        .checklist-checkbox { width: 22px; height: 22px; border: 2px solid var(--light-gray); border-radius: 4px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.2s ease; }
        .checklist-item.checked .checklist-checkbox { background: var(--success); border-color: var(--success); }
        .checklist-item.checked .checklist-checkbox::after { content: '‚úì'; color: white; font-weight: 700; }
        .content-tabs { display: flex; border-bottom: 2px solid var(--medium-gray); margin-bottom: 1.5rem; }
        .content-tab { padding: 0.75rem 1.5rem; background: none; border: none; color: var(--muted-gray); cursor: pointer; font-weight: 500; transition: all 0.2s ease; border-bottom: 2px solid transparent; margin-bottom: -2px; }
        .content-tab:hover { color: var(--text-gray); }
        .content-tab.active { color: white; border-bottom-color: var(--primary-red); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .notes-panel { background: var(--black); border: 1px solid var(--medium-gray); border-radius: 8px; padding: 1rem; }
        .notes-panel textarea { width: 100%; min-height: 150px; background: transparent; border: none; color: var(--text-gray); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; resize: vertical; }
        .notes-panel textarea:focus { outline: none; }
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 2rem; }
        .modal-overlay.show { display: flex; }
        .modal { background: var(--dark-gray); border-radius: 12px; max-width: 800px; width: 100%; max-height: 80vh; overflow-y: auto; border: 2px solid var(--primary-red); }
        .modal-header { background: var(--primary-red); padding: 1.25rem 1.5rem; display: flex; justify-content: space-between; align-items: center; }
        .modal-title { font-weight: 700; color: white; }
        .modal-close { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        .modal-close:hover { background: rgba(255, 255, 255, 0.2); }
        .modal-body { padding: 1.5rem; }
        .completion-badge { text-align: center; padding: 3rem; }
        .badge-icon { font-size: 5rem; margin-bottom: 1rem; }
        .badge-title { font-size: 2rem; font-weight: 700; color: white; margin-bottom: 0.5rem; }
        .badge-subtitle { color: var(--muted-gray); font-size: 1.1rem; }
        .score-display { text-align: center; padding: 2rem; }
        .score-circle { width: 150px; height: 150px; border-radius: 50%; background: var(--medium-gray); border: 6px solid var(--primary-red); display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 0 auto 1.5rem; }
        .score-value { font-size: 3rem; font-weight: 700; color: white; font-family: 'JetBrains Mono', monospace; }
        .score-label { color: var(--muted-gray); font-size: 0.9rem; }
        .drag-container { display: flex; flex-wrap: wrap; gap: 1rem; margin: 1rem 0; }
        .drag-item { background: var(--medium-gray); border: 2px solid var(--light-gray); padding: 0.75rem 1rem; border-radius: 6px; cursor: grab; transition: all 0.2s ease; font-size: 0.9rem; }
        .drag-item:active { cursor: grabbing; }
        .drag-item.dragging { opacity: 0.5; transform: scale(1.05); }
        .drop-zone { min-height: 60px; border: 2px dashed var(--light-gray); border-radius: 8px; padding: 1rem; margin: 0.5rem 0; transition: all 0.2s ease; display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center; }
        .drop-zone.drag-over { border-color: var(--primary-red); background: rgba(220, 38, 38, 0.1); }
        .drop-zone-label { font-weight: 600; margin-bottom: 0.5rem; color: white; }
        .kill-chain { display: flex; overflow-x: auto; gap: 0; margin: 1.5rem 0; padding: 1rem 0; }
        .kill-chain-stage { flex: 1; min-width: 130px; text-align: center; position: relative; }
        .kill-chain-stage::after { content: '‚Üí'; position: absolute; right: -12px; top: 50%; transform: translateY(-50%); color: var(--muted-gray); font-size: 1.5rem; }
        .kill-chain-stage:last-child::after { display: none; }
        .stage-box { background: var(--medium-gray); border: 2px solid var(--light-gray); border-radius: 8px; padding: 1rem 0.5rem; margin: 0 0.25rem; transition: all 0.2s ease; cursor: pointer; }
        .stage-box:hover, .stage-box.active { border-color: var(--primary-red); background: rgba(220, 38, 38, 0.2); }
        .stage-name { font-weight: 600; font-size: 0.8rem; color: white; margin-bottom: 0.25rem; }
        .stage-number { font-size: 0.7rem; color: var(--muted-gray); }
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            h1 { font-size: 1.75rem; }
            .nav-list { flex-direction: column; }
            .nav-item { min-width: 100%; }
            .kill-chain { flex-direction: column; }
            .kill-chain-stage::after { content: '‚Üì'; right: auto; bottom: -20px; top: auto; left: 50%; transform: translateX(-50%); }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&amp;family=JetBrains+Mono:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
</head><body><header>
<div class="header-content"><span class="week-badge">WEEK 14</span> <span class="capstone-badge">üèÜ CAPSTONE</span>
<h1>SOC Level 1 <span class="highlight">Capstone Challenges</span></h1>
<p class="subtitle">Integrate everything into full investigations‚Äîfrom initial alerts through professional reporting</p>
</div>
</header>
<div class="container">
<div class="progress-container">
<div class="progress-header"><span class="progress-title">üìä Module Progress</span> <span class="progress-stats"><span id="progress-text">0</span>% Complete</span></div>
<div class="progress-bar">
<div class="progress-fill" id="progress-fill"></div>
</div>
</div>
<nav>
<ul class="nav-list" id="nav-list">
<li class="nav-item"><a href="#" class="nav-link active" data-section="0">1. Introduction</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="1">2. End-to-End Investigations</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="2">3. Multi-Stage Attacks</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="3">4. Detection Gaps</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="4">5. Professional Reporting</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="5">6. Warm-Up Investigation</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="6">7. Capstone: Meridian Steel</a></li>
<li class="nav-item"><a href="#" class="nav-link" data-section="7">8. Final Report</a></li>
</ul>
</nav><!-- Section 1: Introduction -->
<section id="section-0" class="active">
<div class="section-header">
<div class="section-number">1</div>
<h2>Welcome to Your Capstone Challenge</h2>
</div>
<div class="critical-box">
<div class="box-title">üèÜ Capstone Module</div>
<p>This is your final examination as a SOC Level 1 Analyst. You will apply everything you've learned throughout this course to conduct complete security investigations from initial alert to final report.</p>
</div>
<h3>Course Journey Recap</h3>
<p>Over the past 13 weeks, you've built a comprehensive foundation in defensive security operations:</p>
<div class="timeline">
<div class="timeline-item">
<div class="timeline-time">Weeks 1-3</div>
<div class="timeline-content"><strong>SOC Foundations</strong> - Understanding the SOC environment, analyst roles, alert triage, and basic log analysis</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Weeks 4-6</div>
<div class="timeline-content"><strong>Network Security</strong> - TCP/IP fundamentals, protocol analysis, network attacks, and traffic monitoring with Wireshark</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Weeks 7-9</div>
<div class="timeline-content"><strong>System Security</strong> - Endpoint detection and response, Windows and Linux security monitoring, log collection</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Weeks 10-12</div>
<div class="timeline-content"><strong>Advanced Topics</strong> - SIEM operations, threat intelligence, MITRE ATT&amp;CK, Cyber Kill Chain, malware analysis basics</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Week 13</div>
<div class="timeline-content"><strong>Incident Response</strong> - IR lifecycle, evidence handling, documentation, and communication</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Week 14 (Now)</div>
<div class="timeline-content"><strong>Capstone Integration</strong> - Bringing it all together in realistic, end-to-end investigations</div>
</div>
</div>
<h3>What You'll Accomplish Today</h3>
<ol>
<li><strong>Master End-to-End Investigation Methodology</strong> - Learn the structured approach to conducting complete investigations</li>
<li><strong>Analyze Multi-Stage Attacks</strong> - Map real attack activity to kill chain and ATT&amp;CK frameworks</li>
<li><strong>Identify Detection Gaps</strong> - Reflect on what was detected versus what was missed</li>
<li><strong>Write Professional Reports</strong> - Structure clear, actionable SOC reports for various stakeholders</li>
<li><strong>Complete a Warm-Up Investigation</strong> - Practice with a shorter scenario before the main event</li>
<li><strong>Conduct the Main Capstone Investigation</strong> - Investigate a sophisticated attack against Meridian Steel Industries</li>
<li><strong>Generate Your Final Report</strong> - Produce a professional incident report documenting your findings</li>
</ol>
<div class="info-box">
<div class="box-title">‚è±Ô∏è Time Investment</div>
<p>This module is designed for 4-5 hours of focused work. Take breaks as needed, but try to complete the capstone investigation in one session to simulate real-world conditions.</p>
</div>
<h3>Introducing Meridian Steel Industries</h3>
<div class="report-section">
<div class="report-section-title">üè≠ Company Profile: Meridian Steel Industries</div>
<table>
<tbody>
<tr>
<th style="width: 30%;">Attribute</th>
<th>Details</th>
</tr>
<tr>
<td><strong>Industry</strong></td>
<td>Steel Manufacturing</td>
</tr>
<tr>
<td><strong>Employees</strong></td>
<td>~500 (350 production, 150 corporate)</td>
</tr>
<tr>
<td><strong>Headquarters</strong></td>
<td>Pittsburgh, Pennsylvania</td>
</tr>
<tr>
<td><strong>IT Environment</strong></td>
<td>Windows-dominant corporate network, Active Directory, Microsoft 365</td>
</tr>
<tr>
<td><strong>OT Environment</strong></td>
<td>Industrial Control Systems (ICS), SCADA systems for furnace control</td>
</tr>
<tr>
<td><strong>Security Team</strong></td>
<td>1 CISO, 2 Security Engineers, 3 SOC Analysts (you are one)</td>
</tr>
</tbody>
</table>
</div>
<div class="warning-box">
<div class="box-title">‚ö†Ô∏è Manufacturing Environment Considerations</div>
<p>Manufacturing environments present unique security challenges including IT/OT convergence, legacy systems, safety concerns, and business continuity requirements.</p>
</div>
<h3>Knowledge Check: Are You Ready?</h3>
<div class="exercise-container">
<div class="exercise-header">
<div class="exercise-icon">‚úì</div>
<span class="exercise-title">Pre-Capstone Readiness Quiz</span></div>
<div class="quiz-question" data-quiz="readiness-1">
<p class="question-text">1. What framework maps adversary tactics and techniques to a matrix format?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="readiness-1"><span class="option-indicator">A</span><span>NIST Cybersecurity Framework</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="readiness-1"><span class="option-indicator">B</span><span>MITRE ATT&amp;CK</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="readiness-1"><span class="option-indicator">C</span><span>ISO 27001</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="readiness-1"><span class="option-indicator">D</span><span>PCI DSS</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="readiness-2">
<p class="question-text">2. In the Cyber Kill Chain, which phase comes immediately after "Delivery"?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="readiness-2"><span class="option-indicator">A</span><span>Installation</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="readiness-2"><span class="option-indicator">B</span><span>Command &amp; Control</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="readiness-2"><span class="option-indicator">C</span><span>Exploitation</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="readiness-2"><span class="option-indicator">D</span><span>Actions on Objectives</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="readiness-3">
<p class="question-text">3. What Windows event ID indicates a successful logon?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="readiness-3"><span class="option-indicator">A</span><span>4625</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="readiness-3"><span class="option-indicator">B</span><span>4624</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="readiness-3"><span class="option-indicator">C</span><span>4688</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="readiness-3"><span class="option-indicator">D</span><span>4720</span></label></div>
<div class="quiz-feedback"></div>
</div>
<button class="btn btn-primary" onclick="checkQuiz('readiness')">Check Answers</button></div>
<div class="btn-group"><button class="btn btn-primary" onclick="navigateSection(1)">Begin Your Capstone Journey ‚Üí</button></div>
</section>
<!-- Section 2: End-to-End Investigations -->
<section id="section-1">
<div class="section-header">
<div class="section-number">2</div>
<h2>End-to-End SOC Investigations</h2>
</div>
<p>Professional SOC investigations follow a structured methodology that transforms a single alert into a complete understanding of an incident.</p>
<h3>The Investigation Lifecycle</h3>
<div class="kill-chain">
<div class="kill-chain-stage">
<div class="stage-box active">
<div class="stage-number">PHASE 1</div>
<div class="stage-name">Alert Triage</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box">
<div class="stage-number">PHASE 2</div>
<div class="stage-name">Enrichment</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box">
<div class="stage-number">PHASE 3</div>
<div class="stage-name">Correlation</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box">
<div class="stage-number">PHASE 4</div>
<div class="stage-name">Timeline</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box">
<div class="stage-number">PHASE 5</div>
<div class="stage-name">Scoping</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box">
<div class="stage-number">PHASE 6</div>
<div class="stage-name">Reporting</div>
</div>
</div>
</div>
<h4>Phase 1: Alert Triage</h4>
<p>When an alert arrives, your first task is rapid assessment: Is this a true positive? What's the severity? Does it need immediate escalation?</p>
<h4>Phase 2: Enrichment</h4>
<p>Gather additional context about users, assets, threat intelligence, and historical patterns.</p>
<h4>Phase 3: Correlation</h4>
<p>Connect the dots between different data sources using time-based, entity-based, and technique-based correlation.</p>
<h4>Phase 4: Timeline Construction</h4>
<p>Build a chronological narrative of events. This is often the most time-consuming but most valuable phase:</p>
<pre>Timeline Example:
09:15:23  Email received (phishing) - user jsmith@company.com
09:17:45  Email attachment opened - INVOICE_2024.docm
09:17:48  Macro execution detected - WINWORD.EXE ‚Üí cmd.exe
09:18:03  C2 connection established - 185.234.xx.xx:443
09:45:00  ‚Üê Alert triggered (initial detection point)</pre>
<h4>Phase 5: Scoping</h4>
<p>Determine the full extent: affected systems, compromised users, data impact, and persistence mechanisms.</p>
<h4>Phase 6: Reporting</h4>
<p>Document your findings in a format that supports decision-making. We'll cover this in depth in Section 5.</p>
<h3>Using Multiple Tools Together</h3>
<table>
<tbody>
<tr>
<th>Tool Type</th>
<th>Primary Use</th>
<th>Key Capabilities</th>
</tr>
<tr>
<td>SIEM</td>
<td>Central log aggregation</td>
<td>Correlation, historical queries, alerting</td>
</tr>
<tr>
<td>EDR</td>
<td>Endpoint visibility</td>
<td>Process trees, file activity, network connections</td>
</tr>
<tr>
<td>Network Tools</td>
<td>Traffic analysis</td>
<td>Firewall logs, proxy logs, NetFlow, DNS</td>
</tr>
<tr>
<td>CTI Platforms</td>
<td>Threat context</td>
<td>IOC lookup, actor profiles, campaign tracking</td>
</tr>
<tr>
<td>Ticketing</td>
<td>Documentation</td>
<td>Investigation notes, collaboration, audit trail</td>
</tr>
</tbody>
</table>
<h3>Starting from a Single Alert</h3>
<div class="alert-card critical" style="cursor: default;">
<div class="alert-header"><span class="alert-title">Suspicious PowerShell Execution</span> <span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">ALERT-2024-1847 | 2024-03-15 14:32:17 UTC | Host: WKS-FINANCE-042 | User: mthompson</div>
</div>
<div class="exercise-container">
<div class="exercise-header">
<div class="exercise-icon">üß†</div>
<span class="exercise-title">Knowledge Check: Initial Alert Analysis</span></div>
<pre>Alert: Suspicious PowerShell Execution
Host: WKS-FINANCE-042 (10.50.20.42)
User: mthompson (Finance Department)
Process: powershell.exe -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABO...
Parent Process: WINWORD.EXE</pre>
<div class="quiz-question" data-quiz="alert-1">
<p class="question-text">Based on this alert, what is the MOST concerning indicator?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="alert-1"><span class="option-indicator">A</span><span>The user is from the Finance department</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="alert-1"><span class="option-indicator">B</span><span>PowerShell is being executed</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="alert-1"><span class="option-indicator">C</span><span>WINWORD.EXE is the parent process of PowerShell</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="alert-1"><span class="option-indicator">D</span><span>The command is encoded</span></label></div>
<div class="quiz-feedback"></div>
</div>
<button class="btn btn-primary" onclick="checkQuiz('alert')">Check Answer</button></div>
<div class="success-box">
<div class="box-title">‚úÖ Key Takeaway</div>
<p>The parent-child process relationship (Word ‚Üí PowerShell) is the most significant indicator. Legitimate PowerShell usage rarely originates from Office applications. This pattern strongly suggests macro-based malware delivery.</p>
</div>
<div class="btn-group"><button class="btn btn-secondary" onclick="navigateSection(0)">‚Üê Previous</button> <button class="btn btn-primary" onclick="completeSection(1); navigateSection(2);">Continue to Multi-Stage Attacks ‚Üí</button></div>
</section>
<!-- Section 3: Multi-Stage Attack Scenarios -->
<section id="section-2">
<div class="section-header">
<div class="section-number">3</div>
<h2>Multi-Stage Attack Scenarios</h2>
</div>
<p>Real attacks don't happen in isolation‚Äîthey unfold across multiple stages as attackers work toward their objectives.</p>
<h3>The Cyber Kill Chain</h3>
<div class="kill-chain" id="killchain-viz">
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(0)">
<div class="stage-number">1</div>
<div class="stage-name">Reconnaissance</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(1)">
<div class="stage-number">2</div>
<div class="stage-name">Weaponization</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(2)">
<div class="stage-number">3</div>
<div class="stage-name">Delivery</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(3)">
<div class="stage-number">4</div>
<div class="stage-name">Exploitation</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(4)">
<div class="stage-number">5</div>
<div class="stage-name">Installation</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(5)">
<div class="stage-number">6</div>
<div class="stage-name">C2</div>
</div>
</div>
<div class="kill-chain-stage">
<div class="stage-box" onclick="showKillChainDetail(6)">
<div class="stage-number">7</div>
<div class="stage-name">Actions</div>
</div>
</div>
</div>
<div id="killchain-detail" class="info-box" style="display: none;">
<div class="box-title" id="killchain-detail-title">Click a stage above</div>
<p id="killchain-detail-text"></p>
</div>
<h3>MITRE ATT&amp;CK Framework</h3>
<table>
<tbody>
<tr>
<th>ATT&amp;CK Tactic</th>
<th>Description</th>
<th>Example Techniques</th>
</tr>
<tr>
<td>Initial Access</td>
<td>How attackers get in</td>
<td>Phishing (T1566), Valid Accounts (T1078)</td>
</tr>
<tr>
<td>Execution</td>
<td>Running malicious code</td>
<td>PowerShell (T1059.001), Command Shell (T1059.003)</td>
</tr>
<tr>
<td>Persistence</td>
<td>Maintaining access</td>
<td>Registry Run Keys (T1547.001), Scheduled Tasks (T1053)</td>
</tr>
<tr>
<td>Privilege Escalation</td>
<td>Getting higher privileges</td>
<td>Token Manipulation (T1134), Exploitation (T1068)</td>
</tr>
<tr>
<td>Credential Access</td>
<td>Stealing credentials</td>
<td>OS Credential Dumping (T1003), Keylogging (T1056)</td>
</tr>
<tr>
<td>Lateral Movement</td>
<td>Moving through network</td>
<td>Remote Services (T1021), Pass-the-Hash (T1550.002)</td>
</tr>
<tr>
<td>Exfiltration</td>
<td>Stealing data out</td>
<td>Exfil over C2 (T1041), Exfil to Cloud (T1567)</td>
</tr>
<tr>
<td>Impact</td>
<td>Damage or disruption</td>
<td>Data Encrypted (T1486), System Shutdown (T1529)</td>
</tr>
</tbody>
</table>
<h3>Attack Mapping Exercise</h3>
<div class="exercise-container">
<div class="exercise-header">
<div class="exercise-icon">üó∫Ô∏è</div>
<span class="exercise-title">Map Attack Events to Frameworks</span></div>
<p>Review this attack timeline:</p>
<div class="timeline">
<div class="timeline-item">
<div class="timeline-time">Day 1 - 09:15</div>
<div class="timeline-content"><strong>Event A:</strong> User receives email with attached Excel file from spoofed CFO address</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Day 1 - 09:22</div>
<div class="timeline-content"><strong>Event B:</strong> User opens attachment, enables macros. PowerShell downloads payload</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Day 1 - 09:23</div>
<div class="timeline-content"><strong>Event C:</strong> Scheduled task "WindowsUpdate" created for persistence</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Day 1 - 09:25</div>
<div class="timeline-content"><strong>Event D:</strong> C2 beacon established to 185.234.72[.]91 over HTTPS</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Day 2 - 02:15</div>
<div class="timeline-content"><strong>Event E:</strong> Mimikatz extracts domain admin credentials from memory</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Day 2 - 02:45</div>
<div class="timeline-content"><strong>Event F:</strong> Attacker RDPs to domain controller using stolen creds</div>
</div>
<div class="timeline-item">
<div class="timeline-time">Day 2 - 03:30</div>
<div class="timeline-content"><strong>Event G:</strong> 2.3GB ZIP uploaded to file-sharing service</div>
</div>
</div>
<div class="quiz-question" data-quiz="mapping-1">
<p class="question-text">Which Kill Chain stage does Event A (phishing email) represent?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="mapping-1"><span class="option-indicator">A</span><span>Reconnaissance</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="mapping-1"><span class="option-indicator">B</span><span>Weaponization</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="mapping-1"><span class="option-indicator">C</span><span>Delivery</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="mapping-1"><span class="option-indicator">D</span><span>Exploitation</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="mapping-2">
<p class="question-text">Event C (scheduled task creation) maps to which ATT&amp;CK tactic?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="mapping-2"><span class="option-indicator">A</span><span>Execution</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="mapping-2"><span class="option-indicator">B</span><span>Persistence</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="mapping-2"><span class="option-indicator">C</span><span>Defense Evasion</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="mapping-2"><span class="option-indicator">D</span><span>Privilege Escalation</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="mapping-3">
<p class="question-text">Event E (Mimikatz credential extraction) maps to which ATT&amp;CK tactic?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="mapping-3"><span class="option-indicator">A</span><span>Discovery</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="mapping-3"><span class="option-indicator">B</span><span>Collection</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="mapping-3"><span class="option-indicator">C</span><span>Credential Access</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="mapping-3"><span class="option-indicator">D</span><span>Privilege Escalation</span></label></div>
<div class="quiz-feedback"></div>
</div>
<button class="btn btn-primary" onclick="checkQuiz('mapping')">Check Answers</button></div>
<div class="btn-group"><button class="btn btn-secondary" onclick="navigateSection(1)">‚Üê Previous</button> <button class="btn btn-primary" onclick="completeSection(2); navigateSection(3);">Continue to Detection Gaps ‚Üí</button></div>
</section>
<!-- Section 4: Detection Coverage and Gaps -->
<section id="section-3">
<div class="section-header">
<div class="section-number">4</div>
<h2>Detection Coverage and Gaps</h2>
</div>
<p>No security program has perfect visibility. Understanding what you can detect‚Äîand what you might miss‚Äîis essential for continuous improvement.</p>
<h3>The Detection Pyramid</h3>
<pre style="text-align: center;">        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ   TTPs    ‚îÇ  ‚Üê Most robust (detect techniques)
      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
     ‚îÇ    Tools     ‚îÇ  ‚Üê Detect specific attacker tools
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
   ‚îÇ   Artifacts    ‚îÇ  ‚Üê Files, registry keys (easily changed)
  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
 ‚îÇ   Hash Values    ‚îÇ  ‚Üê Specific file hashes (trivially changed)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</pre>
<p>The goal is to move your detections <strong>up the pyramid</strong>‚Äîdetecting behaviors and techniques rather than specific indicators.</p>
<h3>Assessing Your Detection Coverage</h3>
<table>
<tbody>
<tr>
<th>Attack Stage</th>
<th>What Should We Detect?</th>
<th>Common Gaps</th>
</tr>
<tr>
<td>Initial Access</td>
<td>Malicious attachments, suspicious links</td>
<td>Encrypted attachments, legitimate services</td>
</tr>
<tr>
<td>Execution</td>
<td>Process creation, unusual parent-child</td>
<td>Living-off-the-land, fileless malware</td>
</tr>
<tr>
<td>Persistence</td>
<td>Registry changes, scheduled tasks</td>
<td>Novel locations, WMI subscriptions</td>
</tr>
<tr>
<td>Credential Access</td>
<td>LSASS access, failed auth attempts</td>
<td>Offline attacks, credential files</td>
</tr>
<tr>
<td>Lateral Movement</td>
<td>Unusual auth patterns</td>
<td>Admin-to-admin movement</td>
</tr>
<tr>
<td>Exfiltration</td>
<td>Large outbound transfers</td>
<td>Encrypted channels, slow exfil</td>
</tr>
</tbody>
</table>
<h3>Reflection Questions</h3>
<ul class="checklist" id="reflection-checklist">
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>At what stage did we first detect this incident?</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>How long were attackers present before detection (dwell time)?</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Were there earlier indicators we could have caught?</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Did we have the logs we needed to investigate?</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>What stages of the attack had no visibility?</span></li>
</ul>
<h3>Gap Analysis Exercise</h3>
<div class="exercise-container">
<div class="exercise-header">
<div class="exercise-icon">üîç</div>
<span class="exercise-title">Identify the Detection Gaps</span></div>
<p>A company experienced a ransomware attack:</p>
<ul>
<li>‚úÖ Detected: Ransomware execution on multiple servers</li>
<li>‚úÖ Detected: Lateral movement via RDP</li>
<li>‚úÖ Detected: Mimikatz execution</li>
<li>‚ùå Not Detected: Initial access method</li>
<li>‚ùå Not Detected: C2 communications</li>
<li>‚ùå Not Detected: Data exfiltration</li>
</ul>
<div class="quiz-question" data-quiz="gap-1">
<p class="question-text">Which log source would MOST likely help identify the initial access vector?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="true"><input type="radio" name="gap-1"><span class="option-indicator">A</span><span>Email gateway logs</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="gap-1"><span class="option-indicator">B</span><span>DHCP logs</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="gap-1"><span class="option-indicator">C</span><span>Print server logs</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="gap-1"><span class="option-indicator">D</span><span>Badge access logs</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="gap-2">
<p class="question-text">To detect the missed C2 communications, what would be the BEST enhancement?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="gap-2"><span class="option-indicator">A</span><span>Deploy additional antivirus</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="gap-2"><span class="option-indicator">B</span><span>Implement DNS logging and proxy with SSL inspection</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="gap-2"><span class="option-indicator">C</span><span>Add more Windows event log forwarding</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="gap-2"><span class="option-indicator">D</span><span>Enable file integrity monitoring</span></label></div>
<div class="quiz-feedback"></div>
</div>
<button class="btn btn-primary" onclick="checkQuiz('gap')">Check Answers</button></div>
<div class="btn-group"><button class="btn btn-secondary" onclick="navigateSection(2)">‚Üê Previous</button> <button class="btn btn-primary" onclick="completeSection(3); navigateSection(4);">Continue to Professional Reporting ‚Üí</button></div>
</section>
<!-- Section 5: Professional SOC Reporting -->
<section id="section-4">
<div class="section-header">
<div class="section-number">5</div>
<h2>Capstone Reporting</h2>
</div>
<p>Your investigation is only as valuable as your ability to communicate findings clearly.</p>
<h3>Report Structure</h3>
<table>
<tbody>
<tr>
<th>Section</th>
<th>Purpose</th>
<th>Key Elements</th>
</tr>
<tr>
<td>Executive Summary</td>
<td>Leadership overview</td>
<td>One-liner, impact, status, key recommendations</td>
</tr>
<tr>
<td>Timeline</td>
<td>Chronological narrative</td>
<td>UTC timestamps, sources, actor vs defender actions</td>
</tr>
<tr>
<td>Technical Analysis</td>
<td>Detailed findings</td>
<td>Attack vector, malware, techniques, evidence</td>
</tr>
<tr>
<td>IOCs</td>
<td>Actionable indicators</td>
<td>IPs, domains, hashes, file paths</td>
</tr>
<tr>
<td>Impact Assessment</td>
<td>Quantify damage</td>
<td>Systems, accounts, data affected</td>
</tr>
<tr>
<td>Recommendations</td>
<td>Actionable next steps</td>
<td>Immediate, short-term, long-term actions</td>
</tr>
</tbody>
</table>
<h3>Writing for Different Audiences</h3>
<table>
<tbody>
<tr>
<th>Audience</th>
<th>What They Need</th>
<th>Language Style</th>
</tr>
<tr>
<td>Executive Leadership</td>
<td>Business impact, risk, cost</td>
<td>Non-technical, outcomes-focused</td>
</tr>
<tr>
<td>IT Management</td>
<td>Affected systems, remediation</td>
<td>Mix of technical and business</td>
</tr>
<tr>
<td>Security Team</td>
<td>TTPs, IOCs, detection gaps</td>
<td>Technical detail, framework mappings</td>
</tr>
<tr>
<td>Legal/Compliance</td>
<td>Data impact, notification needs</td>
<td>Precise, factual, documented</td>
</tr>
</tbody>
</table>
<div class="warning-box">
<div class="box-title">‚ùå Common Reporting Mistakes</div>
<ul>
<li><strong>Too much jargon</strong> - "The TA leveraged LOLBins" ‚Üí "The attacker used built-in Windows tools"</li>
<li><strong>Missing timestamps</strong> - Always include UTC times</li>
<li><strong>Unsupported conclusions</strong> - Back every claim with evidence</li>
<li><strong>Buried key findings</strong> - Put important information first</li>
</ul>
</div>
<div class="btn-group"><button class="btn btn-secondary" onclick="navigateSection(3)">‚Üê Previous</button> <button class="btn btn-primary" onclick="completeSection(4); navigateSection(5);">Continue to Warm-Up Investigation ‚Üí</button></div>
</section>
<!-- Section 6: Warm-Up Investigation -->
<section id="section-5">
<div class="section-header">
<div class="section-number">6</div>
<h2>Warm-Up Investigation: Business Email Compromise</h2>
</div>
<div class="info-box">
<div class="box-title">üéØ Scenario Overview</div>
<p>Before the main capstone, let's practice with a shorter investigation. ACME Corp's SOC received an alert about suspicious email activity. Investigate and answer the questions.</p>
</div>
<h3>Initial Alert</h3>
<div class="alert-card high">
<div class="alert-header"><span class="alert-title">Suspicious Email Forwarding Rule Created</span> <span class="alert-severity severity-high">HIGH</span></div>
<div class="alert-meta">ALERT-2024-0847 | 2024-03-12 11:45:22 UTC | User: kmartin@acmecorp.com</div>
</div>
<h3>Available Evidence</h3>
<div class="content-tabs"><button class="content-tab active" onclick="showContentTab('warmup-vpn', 'warmup-tab')">VPN Logs</button> <button class="content-tab" onclick="showContentTab('warmup-ad', 'warmup-tab')">AD Logs</button> <button class="content-tab" onclick="showContentTab('warmup-email', 'warmup-tab')">Email Activity</button> <button class="content-tab" onclick="showContentTab('warmup-cti', 'warmup-tab')">CTI Lookup</button></div>
<div id="warmup-vpn" class="tab-content warmup-tab active">
<h4>VPN Authentication Logs - kmartin</h4>
<div class="log-viewer">
<div class="log-header"><span>GlobalProtect VPN - Last 7 Days</span></div>
<div class="log-entry"><span class="log-timestamp">2024-03-05 08:15:22</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN SUCCESS kmartin - IP: 73.162.45.xx (Pittsburgh, PA) - Device: YOURPC</span></div>
<div class="log-entry"><span class="log-timestamp">2024-03-06 07:58:11</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN SUCCESS kmartin - IP: 73.162.45.xx (Pittsburgh, PA) - Device: YOURPC</span></div>
<div class="log-entry"><span class="log-timestamp">2024-03-07 08:22:45</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN SUCCESS kmartin - IP: 73.162.45.xx (Pittsburgh, PA) - Device: YOURPC</span></div>
<div class="log-entry suspicious"><span class="log-timestamp">2024-03-11 23:47:33</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN FAILED kmartin - IP: 185.234.72.91 (Netherlands) - Invalid password</span></div>
<div class="log-entry suspicious"><span class="log-timestamp">2024-03-11 23:47:45</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN FAILED kmartin - IP: 185.234.72.91 (Netherlands) - Invalid password</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-11 23:48:02</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN SUCCESS kmartin - IP: 185.234.72.91 (Netherlands) - Device: Unknown</span></div>
<div class="log-entry"><span class="log-timestamp">2024-03-12 08:05:33</span> <span class="log-source">[VPN]</span> <span class="log-message">LOGIN SUCCESS kmartin - IP: 73.162.45.xx (Pittsburgh, PA) - Device: YOURPC</span></div>
</div>
</div>
<div id="warmup-ad" class="tab-content warmup-tab">
<h4>Active Directory Logs - kmartin</h4>
<div class="log-viewer">
<div class="log-header"><span>Azure AD Sign-In Logs</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-11 23:48:15</span> <span class="log-source">[AzureAD]</span> <span class="log-message">Sign-in SUCCESS - kmartin - App: Microsoft 365 - IP: 185.234.72.91 - MFA: Not Required (trusted location bypass)</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-11 23:52:07</span> <span class="log-source">[AzureAD]</span> <span class="log-message">Sign-in SUCCESS - kmartin - App: Outlook Web - IP: 185.234.72.91</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-12 00:15:33</span> <span class="log-source">[AzureAD]</span> <span class="log-message">Sign-in SUCCESS - kmartin - App: Exchange Admin - IP: 185.234.72.91</span></div>
</div>
</div>
<div id="warmup-email" class="tab-content warmup-tab">
<h4>Email Activity - kmartin@acmecorp.com</h4>
<div class="log-viewer">
<div class="log-header"><span>Exchange Online Audit Log</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-12 00:18:44</span> <span class="log-source">[Exchange]</span> <span class="log-message">New-InboxRule created: "Security Update" - Forward all emails containing "invoice", "payment", "wire" to: ext.backup.kmartin@protonmail.com</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-12 00:22:15</span> <span class="log-source">[Exchange]</span> <span class="log-message">Email sent TO: vendor-payments@supplierco.com FROM: kmartin - Subject: "Updated Banking Information - Urgent"</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-12 00:25:33</span> <span class="log-source">[Exchange]</span> <span class="log-message">Email sent TO: accounts@partnerllc.com FROM: kmartin - Subject: "Wire Transfer Instructions Changed"</span></div>
<div class="log-entry"><span class="log-timestamp">2024-03-12 08:45:00</span> <span class="log-source">[Exchange]</span> <span class="log-message">Email received FROM: vendor-payments@supplierco.com - Subject: "RE: Updated Banking Information - Urgent" - Body: "Please confirm this request by phone"</span></div>
</div>
</div>
<div id="warmup-cti" class="tab-content warmup-tab">
<h4>Threat Intelligence: 185.234.72.91</h4>
<div class="report-section">
<table>
<tbody>
<tr>
<td><strong>IP Address</strong></td>
<td>185.234.72.91</td>
</tr>
<tr>
<td><strong>Location</strong></td>
<td>Amsterdam, Netherlands</td>
</tr>
<tr>
<td><strong>Reputation</strong></td>
<td><span style="color: var(--primary-red);">MALICIOUS</span> - Known for credential stuffing</td>
</tr>
<tr>
<td><strong>Associated Campaigns</strong></td>
<td>BEC attacks targeting US manufacturing sector</td>
</tr>
<tr>
<td><strong>First Seen</strong></td>
<td>2024-01-15</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3>Investigation Questions</h3>
<div class="exercise-container">
<div class="exercise-header">
<div class="exercise-icon">üîç</div>
<span class="exercise-title">Warm-Up Analysis</span></div>
<div class="quiz-question" data-quiz="warmup-1">
<p class="question-text">1. How did the attacker initially gain access to kmartin's account?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="true"><input type="radio" name="warmup-1"><span class="option-indicator">A</span><span>Credential stuffing with previously breached password</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-1"><span class="option-indicator">B</span><span>Phishing email with malicious link</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-1"><span class="option-indicator">C</span><span>Malware on kmartin's workstation</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-1"><span class="option-indicator">D</span><span>Social engineering via phone</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="warmup-2">
<p class="question-text">2. Why wasn't MFA triggered for the attacker's login?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="warmup-2"><span class="option-indicator">A</span><span>MFA was not configured for this user</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="warmup-2"><span class="option-indicator">B</span><span>The VPN connection was marked as a trusted location, bypassing MFA</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-2"><span class="option-indicator">C</span><span>The attacker stole the MFA token</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-2"><span class="option-indicator">D</span><span>MFA was disabled by IT</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="warmup-3">
<p class="question-text">3. What was the attacker's primary objective?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="warmup-3"><span class="option-indicator">A</span><span>Install ransomware</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-3"><span class="option-indicator">B</span><span>Steal intellectual property</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="warmup-3"><span class="option-indicator">C</span><span>Redirect vendor payments through fraudulent banking changes</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-3"><span class="option-indicator">D</span><span>Cryptomining</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="warmup-4">
<p class="question-text">4. What is the purpose of the inbox rule created by the attacker?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="warmup-4"><span class="option-indicator">A</span><span>Delete evidence of the attack</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="warmup-4"><span class="option-indicator">B</span><span>Maintain access to financial communications for ongoing fraud</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-4"><span class="option-indicator">C</span><span>Spread malware to contacts</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-4"><span class="option-indicator">D</span><span>Block the user from receiving emails</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="warmup-5">
<p class="question-text">5. What immediate action should be taken?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="warmup-5"><span class="option-indicator">A</span><span>Wait for more evidence before acting</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="warmup-5"><span class="option-indicator">B</span><span>Reset password, revoke sessions, remove malicious inbox rule, alert vendors</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-5"><span class="option-indicator">C</span><span>Block the IP address at the firewall only</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="warmup-5"><span class="option-indicator">D</span><span>Disable the user's account permanently</span></label></div>
<div class="quiz-feedback"></div>
</div>
<button class="btn btn-primary" onclick="checkQuiz('warmup')">Check Answers</button></div>
<div id="warmup-complete" class="success-box" style="display: none;">
<div class="box-title">‚úÖ Warm-Up Complete!</div>
<p>Great job on the BEC investigation! You're now ready for the main capstone challenge.</p>
</div>
<div class="btn-group"><button class="btn btn-secondary" onclick="navigateSection(4)">‚Üê Previous</button> <button class="btn btn-primary" onclick="completeSection(5); navigateSection(6);">Proceed to Main Capstone ‚Üí</button></div>
</section>
<!-- Section 7: Main Capstone Investigation -->
<section id="section-6">
<div class="section-header">
<div class="section-number">7</div>
<h2>Capstone Investigation: Meridian Steel Industries</h2>
</div>
<div class="critical-box">
<div class="box-title">üö® Active Incident - Priority 1</div>
<p><strong>Scenario:</strong> It's 06:15 UTC on March 18, 2024. You've just received an urgent escalation from the overnight shift. Multiple critical alerts triggered on the domain controller SVR-DC01 showing shadow copy deletion and recovery disabling‚Äîclassic ransomware precursors. Your task: investigate the full scope of this incident.</p>
</div>
<h3>Initial Alerts</h3>
<div class="alert-card critical" onclick="showAlertDetail('alert-10')">
<div class="alert-header"><span class="alert-title">Shadow Copy Deletion Detected</span> <span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">ALERT-2024-1207 | 2024-03-18 06:12:47 UTC | Host: SVR-DC01</div>
</div>
<h3>SOC Workstation</h3>
<p>Use the simulated SOC workstation below to investigate. Click through each tool tab to gather evidence.</p>
<div class="soc-workstation">
<div class="workstation-header">
<div class="workstation-title">üñ•Ô∏è SOC WORKSTATION - Meridian Steel Industries</div>
<div class="workstation-status">
<div class="status-indicator"></div>
<span>LIVE</span></div>
</div>
<div class="workstation-tabs"><button class="workstation-tab active" onclick="showWorkstationPanel('siem-panel')">üìä SIEM <span class="badge">10</span></button> <button class="workstation-tab" onclick="showWorkstationPanel('edr-panel')">üîç EDR</button> <button class="workstation-tab" onclick="showWorkstationPanel('network-panel')">üåê Network</button> <button class="workstation-tab" onclick="showWorkstationPanel('cti-panel')">üéØ CTI</button> <button class="workstation-tab" onclick="showWorkstationPanel('ticket-panel')">üìã Ticket</button> <button class="workstation-tab" onclick="showWorkstationPanel('notes-panel')">üìù Notes</button></div>
<div class="workstation-content"><!-- SIEM Panel -->
<div id="siem-panel" class="tool-panel active">
<h4>SIEM - Alert Queue</h4>
<div class="search-bar"><input type="text" class="search-input" id="siem-search" placeholder="Search logs (try: powershell, mimikatz, lateral, dcsync, exfil)..."> <button class="btn btn-primary" onclick="searchSIEM()">Search</button></div>
<div id="siem-alerts">
<p><strong>Recent Alerts (Sorted by Severity)</strong></p>
<div class="alert-card critical" onclick="showAlertDetail('alert-1')">
<div class="alert-header"><span class="alert-title">Phishing Email - Malicious Attachment</span><span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">2024-03-15 14:23:17 | User: jrodriguez | Attach: Quote_Request_March2024.docm</div>
</div>
<div class="alert-card critical" onclick="showAlertDetail('alert-2')">
<div class="alert-header"><span class="alert-title">Suspicious PowerShell Execution</span><span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">2024-03-15 14:25:42 | Host: WKS-ENG-PC15 | Parent: WINWORD.EXE</div>
</div>
<div class="alert-card critical" onclick="showAlertDetail('alert-3')">
<div class="alert-header"><span class="alert-title">Potential C2 Communication</span><span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">2024-03-15 14:26:03 | Dest: 45.142.213.105:443 | Pattern: HTTPS Beacon</div>
</div>
<div class="alert-card high" onclick="showAlertDetail('alert-4')">
<div class="alert-header"><span class="alert-title">LSASS Memory Access</span><span class="alert-severity severity-high">HIGH</span></div>
<div class="alert-meta">2024-03-16 02:15:33 | Host: WKS-ENG-PC15 | Process: rundll32.exe</div>
</div>
<div class="alert-card high" onclick="showAlertDetail('alert-5')">
<div class="alert-header"><span class="alert-title">Unusual AD Enumeration</span><span class="alert-severity severity-high">HIGH</span></div>
<div class="alert-meta">2024-03-16 02:18:45 | User: jrodriguez | Commands: net user, nltest</div>
</div>
<div class="alert-card high" onclick="showAlertDetail('alert-6')">
<div class="alert-header"><span class="alert-title">Pass-the-Hash Detected</span><span class="alert-severity severity-high">HIGH</span></div>
<div class="alert-meta">2024-03-16 02:45:12 | Source: WKS-ENG-PC15 | Account: svc_sql</div>
</div>
<div class="alert-card high" onclick="showAlertDetail('alert-7')">
<div class="alert-header"><span class="alert-title">Lateral Movement - RDP</span><span class="alert-severity severity-high">HIGH</span></div>
<div class="alert-meta">2024-03-16 02:47:33 | WKS-ENG-PC15 ‚Üí SVR-SQL01 | User: svc_sql</div>
</div>
<div class="alert-card high" onclick="showAlertDetail('alert-8')">
<div class="alert-header"><span class="alert-title">Large Data Archive Created</span><span class="alert-severity severity-high">HIGH</span></div>
<div class="alert-meta">2024-03-17 03:22:15 | Host: SVR-FILE01 | Size: 4.7GB</div>
</div>
<div class="alert-card critical" onclick="showAlertDetail('alert-9')">
<div class="alert-header"><span class="alert-title">DCSync Attack Detected</span><span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">2024-03-17 22:34:18 | Source: SVR-SQL01 | Target: SVR-DC01</div>
</div>
<div class="alert-card critical" onclick="showAlertDetail('alert-10')">
<div class="alert-header"><span class="alert-title">Shadow Copy Deletion</span><span class="alert-severity severity-critical">CRITICAL</span></div>
<div class="alert-meta">2024-03-18 06:12:47 | Host: SVR-DC01 | vssadmin delete shadows</div>
</div>
</div>
<div id="siem-search-results" style="display: none;"></div>
</div>
<!-- EDR Panel -->
<div id="edr-panel" class="tool-panel">
<h4>EDR - Endpoint Detection &amp; Response</h4>
<div class="content-tabs"><button class="content-tab active" onclick="showContentTab('edr-wks', 'edr-tab')">WKS-ENG-PC15</button> <button class="content-tab" onclick="showContentTab('edr-sql', 'edr-tab')">SVR-SQL01</button> <button class="content-tab" onclick="showContentTab('edr-dc', 'edr-tab')">SVR-DC01</button> <button class="content-tab" onclick="showContentTab('edr-file', 'edr-tab')">SVR-FILE01</button></div>
<div id="edr-wks" class="tab-content edr-tab active">
<p><strong>Host:</strong> WKS-ENG-PC15 | <strong>User:</strong> jrodriguez (Engineering)</p>
<p><strong>Process Tree (2024-03-15 14:23 - 14:30):</strong></p>
<div class="process-tree">
<div class="process-node"><span class="process-name">explorer.exe</span> <span class="process-pid">[PID: 4521]</span>
<div class="process-node"><span class="process-name">OUTLOOK.EXE</span> <span class="process-pid">[PID: 6834]</span>
<div class="process-node"><span class="process-suspicious">WINWORD.EXE</span> <span class="process-pid">[PID: 7892]</span>
<div class="process-cmd">‚Üí "Quote_Request_March2024.docm"</div>
<div class="process-node"><span class="process-malicious">cmd.exe</span> <span class="process-pid">[PID: 8234]</span>
<div class="process-node"><span class="process-malicious">powershell.exe</span> <span class="process-pid">[PID: 8456]</span>
<div class="process-cmd">‚Üí Downloads from hxxps://cdn-update[.]com/ms_update.exe</div>
<div class="process-node"><span class="process-malicious">ms_update.exe</span> <span class="process-pid">[PID: 8712]</span>
<div class="process-cmd">‚Üí C:\Users\Public\ms_update.exe (Cobalt Strike)</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p style="margin-top: 1rem;"><strong>Key File Activity:</strong></p>
<table style="font-size: 0.85rem;">
<tbody>
<tr>
<th>Time</th>
<th>Action</th>
<th>Path</th>
</tr>
<tr>
<td>14:23:17</td>
<td>CREATE</td>
<td>Quote_Request_March2024.docm</td>
</tr>
<tr>
<td>14:25:48</td>
<td>CREATE</td>
<td>C:\Users\Public\ms_update.exe</td>
</tr>
<tr>
<td>14:26:01</td>
<td>CREATE</td>
<td>...\Startup\updater.lnk (persistence)</td>
</tr>
</tbody>
</table>
</div>
<div id="edr-sql" class="tab-content edr-tab">
<p><strong>Host:</strong> SVR-SQL01 | <strong>Compromise:</strong> 2024-03-16 02:47:33</p>
<p><strong>Initial Access:</strong> RDP from WKS-ENG-PC15 using svc_sql credentials</p>
<div class="process-tree">
<div class="process-node"><span class="process-name">svchost.exe (TermService)</span>
<div class="process-node"><span class="process-suspicious">rdpclip.exe</span> <span class="process-pid">[User: svc_sql]</span>
<div class="process-node"><span class="process-malicious">cmd.exe</span>
<div class="process-node"><span class="process-malicious">powershell.exe</span>
<div class="process-cmd">‚Üí IEX download from 45.142.213.105</div>
</div>
</div>
</div>
</div>
</div>
<p style="margin-top: 1rem;"><strong>Credential Theft (03-17 22:30):</strong></p>
<pre style="font-size: 0.8rem;">[22:30:15] mimikatz.exe detected (renamed: sqlcheck.exe)
[22:30:22] privilege::debug - SUCCESS
[22:30:25] sekurlsa::logonpasswords - 12 credentials extracted
[22:34:18] lsadump::dcsync - Domain Admin hash extracted</pre>
</div>
<div id="edr-dc" class="tab-content edr-tab">
<p><strong>Host:</strong> SVR-DC01 | <strong>Compromise:</strong> 2024-03-18 06:08:22</p>
<p><strong>Access Method:</strong> PsExec with stolen Domain Admin credentials</p>
<div class="process-tree">
<div class="process-node"><span class="process-name">services.exe</span>
<div class="process-node"><span class="process-malicious">PSEXESVC.exe</span>
<div class="process-node"><span class="process-malicious">cmd.exe</span>
<div class="process-node"><span class="process-malicious">vssadmin.exe</span>
<div class="process-cmd">‚Üí delete shadows /all /quiet</div>
</div>
<div class="process-node"><span class="process-malicious">bcdedit.exe</span>
<div class="process-cmd">‚Üí recoveryenabled no</div>
</div>
</div>
</div>
</div>
</div>
<div class="critical-box" style="margin-top: 1rem;">
<div class="box-title">‚ö†Ô∏è Pre-Ransomware Activity Detected</div>
<p>Shadow copy deletion indicates imminent ransomware deployment!</p>
</div>
</div>
<div id="edr-file" class="tab-content edr-tab">
<p><strong>Host:</strong> SVR-FILE01 | <strong>Activity:</strong> 2024-03-17 03:00-03:45</p>
<p><strong>Suspicious Access by svc_sql:</strong></p>
<table style="font-size: 0.85rem;">
<tbody>
<tr>
<th>Time</th>
<th>Action</th>
<th>Path</th>
</tr>
<tr>
<td>03:05:22</td>
<td>READ</td>
<td>\\SVR-FILE01\Engineering\CAD_Designs\</td>
</tr>
<tr>
<td>03:08:45</td>
<td>READ</td>
<td>\\SVR-FILE01\Finance\Budgets\</td>
</tr>
<tr>
<td>03:12:33</td>
<td>READ</td>
<td>\\SVR-FILE01\HR\Employee_Records\</td>
</tr>
<tr>
<td>03:22:15</td>
<td>CREATE</td>
<td>C:\Windows\Temp\backup_data.7z (4.7GB)</td>
</tr>
</tbody>
</table>
<p style="margin-top: 1rem;"><strong>Exfiltration:</strong></p>
<pre style="font-size: 0.8rem;">[03:35:22] curl.exe POST to hxxps://mega.nz/upload
           ‚Üí backup_data.7z uploaded (4.7GB)
[03:42:18] Secure delete of backup_data.7z</pre>
</div>
</div>
<!-- Network Panel -->
<div id="network-panel" class="tool-panel">
<h4>Network Logs</h4>
<p><strong>Suspicious External Connections:</strong></p>
<div class="log-viewer">
<div class="log-header"><span>Firewall - Outbound</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-15 14:25:52</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW WKS-ENG-PC15 ‚Üí 45.142.213.105:443</span></div>
<div class="log-entry"><span class="log-timestamp">2024-03-15 14:26:03+</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW WKS-ENG-PC15 ‚Üí 45.142.213.105:443 (beacon every 60s)</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-16 02:48:15</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW SVR-SQL01 ‚Üí 45.142.213.105:443 (new beacon)</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-17 03:35:22</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW SVR-FILE01 ‚Üí mega.nz:443 (4.7GB transfer)</span></div>
</div>
<p style="margin-top: 1rem;"><strong>Internal Lateral Movement:</strong></p>
<div class="log-viewer">
<div class="log-header"><span>Firewall - Internal</span></div>
<div class="log-entry suspicious"><span class="log-timestamp">2024-03-16 02:47:33</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW WKS-ENG-PC15 ‚Üí SVR-SQL01:3389 (RDP)</span></div>
<div class="log-entry suspicious"><span class="log-timestamp">2024-03-17 02:55:18</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW SVR-SQL01 ‚Üí SVR-FILE01:445 (SMB)</span></div>
<div class="log-entry suspicious"><span class="log-timestamp">2024-03-17 22:34:18</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW SVR-SQL01 ‚Üí SVR-DC01:389 (LDAP - DCSync)</span></div>
<div class="log-entry malicious"><span class="log-timestamp">2024-03-18 06:08:22</span> <span class="log-source">[FW]</span> <span class="log-message">ALLOW SVR-SQL01 ‚Üí SVR-DC01:445 (PsExec)</span></div>
</div>
</div>
<!-- CTI Panel -->
<div id="cti-panel" class="tool-panel">
<h4>Cyber Threat Intelligence</h4>
<div class="report-section">
<div class="report-section-title">üîç IOC: 45.142.213.105</div>
<table>
<tbody>
<tr>
<td><strong>IP</strong></td>
<td>45.142.213.105</td>
</tr>
<tr>
<td><strong>Location</strong></td>
<td>Netherlands (Hosting Provider)</td>
</tr>
<tr>
<td><strong>Reputation</strong></td>
<td><span style="color: var(--primary-red);">MALICIOUS</span></td>
</tr>
<tr>
<td><strong>Associated</strong></td>
<td>Cobalt Strike, ALPHV/BlackCat Ransomware</td>
</tr>
<tr>
<td><strong>Threat Actor</strong></td>
<td>Affiliated with ALPHV/BlackCat RaaS</td>
</tr>
</tbody>
</table>
</div>
<div class="report-section">
<div class="report-section-title">üîç File: ms_update.exe</div>
<table>
<tbody>
<tr>
<td><strong>SHA256</strong></td>
<td>7d8e9f0a1b2c3d4e5f6a7b8c...</td>
</tr>
<tr>
<td><strong>Detection</strong></td>
<td>Cobalt Strike Beacon (packed)</td>
</tr>
<tr>
<td><strong>AV Rate</strong></td>
<td>42/71 engines</td>
</tr>
</tbody>
</table>
</div>
<div class="info-box">
<div class="box-title">üìã ALPHV/BlackCat Profile</div>
<p><strong>Type:</strong> Ransomware-as-a-Service | <strong>TTPs:</strong> Phishing ‚Üí Cobalt Strike ‚Üí DCSync ‚Üí Double Extortion</p>
<p><strong>Timeline:</strong> Typically deploys ransomware 3-7 days after initial access</p>
</div>
</div>
<!-- Ticket Panel -->
<div id="ticket-panel" class="tool-panel">
<h4>Incident Ticket: INC-2024-0318-001</h4>
<div class="report-section">
<table>
<tbody>
<tr>
<td><strong>Status</strong></td>
<td><span style="color: var(--primary-red);">ACTIVE INVESTIGATION</span></td>
</tr>
<tr>
<td><strong>Priority</strong></td>
<td>P1 - Critical</td>
</tr>
<tr>
<td><strong>Assigned</strong></td>
<td>You (SOC Analyst)</td>
</tr>
</tbody>
</table>
</div>
<h4>Evidence Checklist</h4>
<ul class="checklist" id="evidence-checklist">
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Initial phishing email identified</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Malware samples collected</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>C2 infrastructure identified</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Compromised credentials identified</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Lateral movement path mapped</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Data exfiltration confirmed</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>All compromised hosts identified</span></li>
<li class="checklist-item" onclick="toggleChecklist(this)">
<div class="checklist-checkbox"></div>
<span>Attack timeline constructed</span></li>
</ul>
<div id="evidence-progress" style="margin-top: 1rem; padding: 1rem; background: var(--medium-gray); border-radius: 8px;"><strong>Progress:</strong> <span id="evidence-count">0</span>/8 items</div>
</div>
<!-- Notes Panel -->
<div id="notes-panel" class="tool-panel">
<h4>Investigation Notes</h4>
<div class="notes-panel"><textarea id="investigation-notes" placeholder="Document your findings here...

Suggested structure:
- Initial observations
- Timeline entries
- Key findings
- IOCs identified
- Recommendations"></textarea></div>
<div class="btn-group"><button class="btn btn-secondary" onclick="clearNotes()">Clear</button> <button class="btn btn-primary" onclick="saveNotes()">Save Notes</button></div>
</div>
</div>
</div>
<h3>Investigation Questions</h3>
<div class="exercise-container">
<div class="exercise-header">
<div class="exercise-icon">üîç</div>
<span class="exercise-title">Capstone Investigation Analysis</span></div>
<div class="quiz-question" data-quiz="capstone-1">
<p class="question-text">1. What was the initial access vector?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="true"><input type="radio" name="capstone-1"><span class="option-indicator">A</span><span>Phishing email with malicious Word document (macro)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-1"><span class="option-indicator">B</span><span>Compromised VPN credentials</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-1"><span class="option-indicator">C</span><span>Exploited public-facing web server</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-1"><span class="option-indicator">D</span><span>Insider threat</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-2">
<p class="question-text">2. Which user's workstation was initially compromised?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-2"><span class="option-indicator">A</span><span>kmartin (Finance)</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-2"><span class="option-indicator">B</span><span>jrodriguez (Engineering)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-2"><span class="option-indicator">C</span><span>svc_sql (Service Account)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-2"><span class="option-indicator">D</span><span>Administrator</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-3">
<p class="question-text">3. What C2 framework was used?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-3"><span class="option-indicator">A</span><span>Metasploit</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-3"><span class="option-indicator">B</span><span>Cobalt Strike</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-3"><span class="option-indicator">C</span><span>Empire</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-3"><span class="option-indicator">D</span><span>Sliver</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-4">
<p class="question-text">4. How did the attacker gain Domain Admin privileges?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-4"><span class="option-indicator">A</span><span>Password spraying</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-4"><span class="option-indicator">B</span><span>Kerberoasting</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-4"><span class="option-indicator">C</span><span>DCSync attack using Mimikatz after compromising svc_sql</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-4"><span class="option-indicator">D</span><span>Found credentials in a text file</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-5">
<p class="question-text">5. How many systems were compromised?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-5"><span class="option-indicator">A</span><span>2 (workstation and DC)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-5"><span class="option-indicator">B</span><span>3 (workstation, SQL, DC)</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-5"><span class="option-indicator">C</span><span>4 (WKS-ENG-PC15, SVR-SQL01, SVR-FILE01, SVR-DC01)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-5"><span class="option-indicator">D</span><span>5 or more</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-6">
<p class="question-text">6. What data was exfiltrated?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-6"><span class="option-indicator">A</span><span>Only Engineering CAD files</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-6"><span class="option-indicator">B</span><span>Only Financial data</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-6"><span class="option-indicator">C</span><span>Engineering, Finance, HR, and Legal data (4.7GB total)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-6"><span class="option-indicator">D</span><span>No data exfiltration detected</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-7">
<p class="question-text">7. What is the total dwell time (initial access to detection)?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-7"><span class="option-indicator">A</span><span>About 12 hours</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-7"><span class="option-indicator">B</span><span>About 24 hours</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-7"><span class="option-indicator">C</span><span>About 64 hours (March 15 14:23 to March 18 06:12)</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-7"><span class="option-indicator">D</span><span>About 1 week</span></label></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz-question" data-quiz="capstone-8">
<p class="question-text">8. Which ransomware group is likely behind this attack?</p>
<div class="quiz-options"><label class="quiz-option" data-correct="false"><input type="radio" name="capstone-8"><span class="option-indicator">A</span><span>LockBit</span></label> <label class="quiz-option" data-correct="true"><input type="radio" name="capstone-8"><span class="option-indicator">B</span><span>ALPHV/BlackCat</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-8"><span class="option-indicator">C</span><span>Conti</span></label> <label class="quiz-option" data-correct="false"><input type="radio" name="capstone-8"><span class="option-indicator">D</span><span>REvil</span></label></div>
<div class="quiz-feedback"></div>
</div>
<button class="btn btn-primary" onclick="checkQuiz('capstone')">Check Answers</button></div>
<div class="btn-group"><button class="btn btn-secondary" onclick="navigateSection(5)">‚Üê Previous</button> <button class="btn btn-primary" onclick="completeSection(6); navigateSection(7);">Proceed to Final Report ‚Üí</button></div>
</section>
<!-- Section 8: Final Report -->
<section id="section-7">
<div class="section-header">
<div class="section-number">8</div>
<h2>Final Capstone Report</h2>
</div>
<div class="info-box">
<div class="box-title">üìÑ Generate Your Professional Report</div>
<p>Complete the sections below to generate your capstone investigation report.</p>
</div>
<form id="capstone-report-form">
<div class="report-section">
<div class="report-section-title">1. Executive Summary</div>
<div class="report-field"><label>Incident Title:</label> <input type="text" id="report-title" placeholder="e.g., Ransomware Precursor Attack - March 2024" required=""></div>
<div class="report-field"><label>One-Line Summary:</label> <input type="text" id="report-oneliner" placeholder="What happened in one sentence" required=""></div>
<div class="report-field"><label>Incident Severity:</label><select id="report-severity" required="">
<option value="">Select severity...</option>
<option value="Critical">Critical - Immediate business impact</option>
<option value="High">High - Significant potential impact</option>
<option value="Medium">Medium - Moderate impact</option>
</select></div>
<div class="report-field"><label>Business Impact Assessment:</label> <textarea id="report-impact" placeholder="Describe the impact on business operations" required=""></textarea></div>
</div>
<div class="report-section">
<div class="report-section-title">2. Attack Timeline (minimum 6 events)</div>
<div id="timeline-entries">
<div class="report-field timeline-entry" style="display: flex; gap: 0.5rem;"><input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;"> <input type="text" class="timeline-event" placeholder="Event description" style="flex: 1;"></div>
<div class="report-field timeline-entry" style="display: flex; gap: 0.5rem;"><input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;"> <input type="text" class="timeline-event" placeholder="Event description" style="flex: 1;"></div>
<div class="report-field timeline-entry" style="display: flex; gap: 0.5rem;"><input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;"> <input type="text" class="timeline-event" placeholder="Event description" style="flex: 1;"></div>
<div class="report-field timeline-entry" style="display: flex; gap: 0.5rem;"><input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;"> <input type="text" class="timeline-event" placeholder="Event description" style="flex: 1;"></div>
<div class="report-field timeline-entry" style="display: flex; gap: 0.5rem;"><input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;"> <input type="text" class="timeline-event" placeholder="Event description" style="flex: 1;"></div>
<div class="report-field timeline-entry" style="display: flex; gap: 0.5rem;"><input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;"> <input type="text" class="timeline-event" placeholder="Event description" style="flex: 1;"></div>
</div>
<button type="button" class="btn btn-secondary" onclick="addTimelineEntry()">+ Add Event</button></div>
<div class="report-section">
<div class="report-section-title">3. Technical Analysis</div>
<div class="report-field"><label>Initial Access Vector:</label> <textarea id="report-initial-access" placeholder="Describe how the attacker gained initial access" required=""></textarea></div>
<div class="report-field"><label>Attack Progression:</label> <textarea id="report-progression" placeholder="Describe privilege escalation, lateral movement, etc." required=""></textarea></div>
<div class="report-field"><label>Threat Actor / Malware:</label> <textarea id="report-actor" placeholder="Identify the likely threat actor based on TTPs and IOCs" required=""></textarea></div>
</div>
<div class="report-section">
<div class="report-section-title">4. Scope of Compromise</div>
<div class="report-field"><label>Compromised Systems:</label> <textarea id="report-systems" placeholder="List all compromised systems" required=""></textarea></div>
<div class="report-field"><label>Compromised Accounts:</label> <textarea id="report-accounts" placeholder="List all compromised accounts" required=""></textarea></div>
<div class="report-field"><label>Data Accessed/Exfiltrated:</label> <textarea id="report-data" placeholder="Describe data impact" required=""></textarea></div>
</div>
<div class="report-section">
<div class="report-section-title">5. Indicators of Compromise</div>
<div class="report-field"><label>IP Addresses:</label> <textarea id="report-ioc-ips" placeholder="e.g., 45.142.213.105 (C2 server)"></textarea></div>
<div class="report-field"><label>Domains:</label> <textarea id="report-ioc-domains" placeholder="e.g., cdn-update[.]com"></textarea></div>
<div class="report-field"><label>File Hashes:</label> <textarea id="report-ioc-hashes" placeholder="SHA256 hashes of malicious files"></textarea></div>
</div>
<div class="report-section">
<div class="report-section-title">6. Recommendations</div>
<div class="report-field"><label>Immediate Actions (24h):</label> <textarea id="report-immediate" placeholder="Urgent containment and response actions" required=""></textarea></div>
<div class="report-field"><label>Short-Term Actions (1 week):</label> <textarea id="report-shortterm" placeholder="Follow-up remediation actions" required=""></textarea></div>
<div class="report-field"><label>Long-Term Improvements (30 days):</label> <textarea id="report-longterm" placeholder="Strategic security improvements" required=""></textarea></div>
</div>
<div class="report-section">
<div class="report-section-title">7. Analyst Information</div>
<div class="report-field"><label>Analyst Name:</label> <input type="text" id="report-analyst" placeholder="Your name" required=""></div>
<div class="report-field"><label>Date:</label> <input type="text" id="report-date" value="2024-03-18" required=""></div>
</div>
<div class="btn-group"><button type="button" class="btn btn-secondary" onclick="validateReport()">Validate Report</button> <button type="button" class="btn btn-primary" onclick="generateReport()">Generate Final Report</button></div>
</form>
<div id="report-validation-feedback" class="quiz-feedback" style="margin-top: 1rem;"></div>
<div id="generated-report" style="display: none; margin-top: 2rem;">
<h3>üìÑ Your Generated Report</h3>
<div id="report-preview" style="background: white; color: black; padding: 2rem; border-radius: 8px; font-family: 'Times New Roman', serif;"></div>
<div class="btn-group" style="margin-top: 1rem;"><button class="btn btn-primary" onclick="downloadReport()">üì• Download Report</button></div>
</div>
</section>
</div>
<!-- Alert Detail Modal -->
<div class="modal-overlay" id="alert-modal">
<div class="modal">
<div class="modal-header"><span class="modal-title" id="modal-alert-title">Alert Details</span> <button class="modal-close" onclick="closeModal()">√ó</button></div>
<div class="modal-body" id="modal-alert-body"></div>
</div>
</div>
<!-- Completion Modal -->
<div class="modal-overlay" id="completion-modal">
<div class="modal">
<div class="modal-header"><span class="modal-title">üéâ Capstone Complete!</span> <button class="modal-close" onclick="closeCompletionModal()">√ó</button></div>
<div class="modal-body">
<div class="completion-badge">
<div class="badge-icon">üèÜ</div>
<div class="badge-title">SOC Level 1 Analyst</div>
<div class="badge-subtitle">Capstone Investigation Complete</div>
</div>
<div class="score-display">
<div class="score-circle">
<div class="score-value" id="final-score">0%</div>
<div class="score-label">Overall Score</div>
</div>
</div>
<div style="text-align: center;">
<p>Congratulations! You have completed the SOC Level 1 Capstone Challenge.</p>
<p>You've demonstrated proficiency in:</p>
<ul style="text-align: left; display: inline-block; margin: 1rem auto;">
<li>End-to-end security investigations</li>
<li>Multi-stage attack analysis</li>
<li>Detection coverage assessment</li>
<li>Professional incident reporting</li>
</ul>
</div>
</div>
</div>
</div>
<p><script>
        // State Management
        let state = {
            currentSection: 0,
            completedSections: [],
            quizScores: {},
            notes: '',
            reportData: {}
        };

        // Load state from localStorage
        function loadState() {
            const saved = localStorage.getItem('cvnp2625-week14-state');
            if (saved) {
                state = JSON.parse(saved);
                updateProgress();
                restoreUI();
            }
        }

        function saveState() {
            localStorage.setItem('cvnp2625-week14-state', JSON.stringify(state));
        }

        function restoreUI() {
            document.querySelectorAll('.nav-link').forEach((link, index) => {
                if (state.completedSections.includes(index)) {
                    link.classList.add('completed');
                }
            });
            if (state.notes) {
                const notesEl = document.getElementById('investigation-notes');
                if (notesEl) notesEl.value = state.notes;
            }
            navigateSection(state.currentSection);
        }

        // Progress tracking
        function updateProgress() {
            const totalSections = 8;
            const completed = state.completedSections.length;
            const percentage = Math.round((completed / totalSections) * 100);
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = percentage;
        }

        function completeSection(sectionIndex) {
            if (!state.completedSections.includes(sectionIndex)) {
                state.completedSections.push(sectionIndex);
                const navLink = document.querySelector(`[data-section="${{sectionIndex}}"]`);
                if (navLink) navLink.classList.add('completed');
                updateProgress();
                saveState();
            }
        }

        // Navigation
        function navigateSection(index) {
            document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            
            const section = document.getElementById('section-' + index);
            const navLink = document.querySelector(`[data-section="${{index}}"]`);
            
            if (section) section.classList.add('active');
            if (navLink) navLink.classList.add('active');
            
            state.currentSection = index;
            saveState();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                navigateSection(parseInt(link.dataset.section));
            });
        });

        // Quiz functionality
        function checkQuiz(quizPrefix) {
            const questions = document.querySelectorAll(`[data-quiz^="${{quizPrefix}}-"]`);
            let correct = 0;
            let total = questions.length;
            
            questions.forEach(question => {
                const options = question.querySelectorAll('.quiz-option');
                const feedback = question.querySelector('.quiz-feedback');
                let answered = false;
                let isCorrect = false;
                
                options.forEach(option => {
                    option.classList.remove('correct', 'incorrect');
                    if (option.classList.contains('selected')) {
                        answered = true;
                        if (option.dataset.correct === 'true') {
                            isCorrect = true;
                            option.classList.add('correct');
                        } else {
                            option.classList.add('incorrect');
                        }
                    }
                    if (option.dataset.correct === 'true') {
                        option.classList.add('correct');
                    }
                });
                
                if (isCorrect) {
                    correct++;
                    feedback.textContent = '‚úì Correct!';
                    feedback.className = 'quiz-feedback show correct';
                } else if (answered) {
                    feedback.textContent = '‚úó Incorrect. See the correct answer above.';
                    feedback.className = 'quiz-feedback show incorrect';
                } else {
                    feedback.textContent = 'Please select an answer.';
                    feedback.className = 'quiz-feedback show incorrect';
                }
            });
            
            state.quizScores[quizPrefix] = { correct, total };
            saveState();
            
            if (quizPrefix === 'warmup' && correct >= 4) {
                document.getElementById('warmup-complete').style.display = 'block';
            }
        }

        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', () => {
                const question = option.closest('.quiz-question');
                question.querySelectorAll('.quiz-option').forEach(o => {
                    o.classList.remove('selected', 'correct', 'incorrect');
                });
                option.classList.add('selected');
                question.querySelector('.quiz-feedback').classList.remove('show');
            });
        });

        // Content tabs
        function showContentTab(tabId, tabClass) {
            document.querySelectorAll(`.${{tabClass}}`).forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        // SOC Workstation
        function showWorkstationPanel(panelId) {
            document.querySelectorAll('.tool-panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.workstation-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(panelId).classList.add('active');
            event.target.classList.add('active');
        }

        // SIEM Search
        function searchSIEM() {
            const query = document.getElementById('siem-search').value.toLowerCase();
            const alerts = document.getElementById('siem-alerts');
            const results = document.getElementById('siem-search-results');
            
            if (!query) {
                alerts.style.display = 'block';
                results.style.display = 'none';
                return;
            }
            
            alerts.style.display = 'none';
            results.style.display = 'block';
            
            const searchData = {
                'powershell': '<div class="log-entry malicious"><span class="log-timestamp">2024-03-15 14:25:42</span> <span class="log-source">[EDR]</span> <span class="log-message">PowerShell.exe -enc ... executed by WINWORD.EXE on WKS-ENG-PC15</span></div><div class="log-entry malicious"><span class="log-timestamp">2024-03-16 02:48:22</span> <span class="log-source">[EDR]</span> <span class="log-message">PowerShell.exe IEX download from 45.142.213.105 on SVR-SQL01</span></div>',
                'mimikatz': '<div class="log-entry malicious"><span class="log-timestamp">2024-03-16 02:15:33</span> <span class="log-source">[EDR]</span> <span class="log-message">LSASS memory access detected - credential dumping (WKS-ENG-PC15)</span></div><div class="log-entry malicious"><span class="log-timestamp">2024-03-17 22:30:22</span> <span class="log-source">[EDR]</span> <span class="log-message">Mimikatz signatures detected in sqlcheck.exe on SVR-SQL01</span></div>',
                'lateral': '<div class="log-entry suspicious"><span class="log-timestamp">2024-03-16 02:47:33</span> <span class="log-source">[Auth]</span> <span class="log-message">RDP login: WKS-ENG-PC15 ‚Üí SVR-SQL01 using svc_sql account</span></div><div class="log-entry suspicious"><span class="log-timestamp">2024-03-18 06:08:22</span> <span class="log-source">[Auth]</span> <span class="log-message">PsExec execution: SVR-SQL01 ‚Üí SVR-DC01 using Administrator</span></div>',
                'dcsync': '<div class="log-entry malicious"><span class="log-timestamp">2024-03-17 22:34:18</span> <span class="log-source">[DC01]</span> <span class="log-message">Event 4662: Directory Service replication from SVR-SQL01 (non-DC source)</span></div>',
                'exfil': '<div class="log-entry malicious"><span class="log-timestamp">2024-03-17 03:35:22</span> <span class="log-source">[Proxy]</span> <span class="log-message">Large upload to mega.nz (4.7GB) from SVR-FILE01</span></div>'
            };
            
            let html = `<p><strong>Search results for "${{query}}":</strong></p>`;
            let found = false;
            
            for (const [key, value] of Object.entries(searchData)) {
                if (query.includes(key) || key.includes(query)) {
                    html += value;
                    found = true;
                }
            }
            
            if (!found) {
                html += '<p style="color: var(--muted-gray);">No results found. Try: powershell, mimikatz, lateral, dcsync, exfil</p>';
            }
            
            results.innerHTML = html;
        }

        // Alert Details
        function showAlertDetail(alertId) {
            const modal = document.getElementById('alert-modal');
            const title = document.getElementById('modal-alert-title');
            const body = document.getElementById('modal-alert-body');
            
            const alertDetails = {
                'alert-1': { title: 'Phishing Email - Malicious Attachment', content: '<p><strong>Time:</strong> 2024-03-15 14:23:17 UTC</p><p><strong>Recipient:</strong> jrodriguez@meridiansteel.com</p><p><strong>Subject:</strong> Quote Request - Urgent Response Needed</p><p><strong>Attachment:</strong> Quote_Request_March2024.docm</p><p><strong>Analysis:</strong> Macro-enabled document containing obfuscated VBA code.</p>' },
                'alert-2': { title: 'Suspicious PowerShell Execution', content: '<p><strong>Time:</strong> 2024-03-15 14:25:42 UTC</p><p><strong>Host:</strong> WKS-ENG-PC15</p><p><strong>Process:</strong> powershell.exe -ep bypass -w hidden -enc [base64]</p><p><strong>Parent:</strong> cmd.exe ‚Üí WINWORD.EXE</p><p><strong>Action:</strong> Downloads ms_update.exe from cdn-update[.]com</p>' },
                'alert-3': { title: 'Potential C2 Communication', content: '<p><strong>Time:</strong> 2024-03-15 14:26:03 UTC</p><p><strong>Source:</strong> WKS-ENG-PC15</p><p><strong>Destination:</strong> 45.142.213.105:443</p><p><strong>Pattern:</strong> HTTPS beaconing every 60 seconds</p><p><strong>Process:</strong> ms_update.exe</p>' },
                'alert-4': { title: 'LSASS Memory Access', content: '<p><strong>Time:</strong> 2024-03-16 02:15:33 UTC</p><p><strong>Host:</strong> WKS-ENG-PC15</p><p><strong>Technique:</strong> Credential dumping via MiniDump</p><p><strong>MITRE:</strong> T1003.001</p>' },
                'alert-5': { title: 'Unusual AD Enumeration', content: '<p><strong>Time:</strong> 2024-03-16 02:18:45 UTC</p><p><strong>User:</strong> jrodriguez</p><p><strong>Commands:</strong> whoami /all, net user /domain, net group "Domain Admins" /domain</p>' },
                'alert-6': { title: 'Pass-the-Hash Detected', content: '<p><strong>Time:</strong> 2024-03-16 02:45:12 UTC</p><p><strong>Source:</strong> WKS-ENG-PC15</p><p><strong>Account:</strong> svc_sql</p><p><strong>MITRE:</strong> T1550.002</p>' },
                'alert-7': { title: 'Lateral Movement - RDP', content: '<p><strong>Time:</strong> 2024-03-16 02:47:33 UTC</p><p><strong>Source:</strong> WKS-ENG-PC15</p><p><strong>Destination:</strong> SVR-SQL01</p><p><strong>Account:</strong> svc_sql (service account interactive logon is abnormal)</p>' },
                'alert-8': { title: 'Large Data Archive Created', content: '<p><strong>Time:</strong> 2024-03-17 03:22:15 UTC</p><p><strong>Host:</strong> SVR-FILE01</p><p><strong>File:</strong> backup_data.7z (4.7GB)</p><p><strong>Source Data:</strong> Engineering, Finance, HR, Legal directories</p>' },
                'alert-9': { title: 'DCSync Attack Detected', content: '<p><strong>Time:</strong> 2024-03-17 22:34:18 UTC</p><p><strong>Source:</strong> SVR-SQL01 (non-DC)</p><p><strong>Target:</strong> SVR-DC01</p><p><strong>Impact:</strong> Domain Admin hash extracted</p><p><strong>MITRE:</strong> T1003.006</p>' },
                'alert-10': { title: 'Shadow Copy Deletion', content: '<p><strong>Time:</strong> 2024-03-18 06:12:47 UTC</p><p><strong>Host:</strong> SVR-DC01</p><p><strong>Commands:</strong> vssadmin delete shadows /all /quiet, wmic shadowcopy delete, bcdedit /set recoveryenabled no</p><p><strong>CRITICAL:</strong> Classic ransomware preparation!</p>' }
            };
            
            const alert = alertDetails[alertId];
            if (alert) {
                title.textContent = alert.title;
                body.innerHTML = alert.content;
                modal.classList.add('show');
            }
        }

        function closeModal() {
            document.getElementById('alert-modal').classList.remove('show');
        }

        function closeCompletionModal() {
            document.getElementById('completion-modal').classList.remove('show');
        }

        // Kill Chain Detail
        function showKillChainDetail(stage) {
            const details = [
                { title: '1. Reconnaissance', text: 'Attacker gathers information about the target through OSINT, LinkedIn, company websites.' },
                { title: '2. Weaponization', text: 'Attacker creates a deliverable payload: malicious document, exploit kit, or trojanized software.' },
                { title: '3. Delivery', text: 'Payload transmitted to target: phishing email, watering hole, USB drop, or supply chain.' },
                { title: '4. Exploitation', text: 'Vulnerability exploited to execute code: macro execution, software vulnerability, or user action.' },
                { title: '5. Installation', text: 'Attacker establishes persistence: malware installed, backdoor created, legitimate tools abused.' },
                { title: '6. Command & Control', text: 'Communication channel established: HTTP/HTTPS beaconing, DNS tunneling, or cloud services.' },
                { title: '7. Actions on Objectives', text: 'Attacker achieves their goal: data theft, ransomware, destruction, or espionage.' }
            ];
            
            const detail = details[stage];
            document.getElementById('killchain-detail').style.display = 'block';
            document.getElementById('killchain-detail-title').textContent = detail.title;
            document.getElementById('killchain-detail-text').textContent = detail.text;
            
            document.querySelectorAll('#killchain-viz .stage-box').forEach((box, i) => {
                box.classList.toggle('active', i === stage);
            });
        }

        // Checklist
        function toggleChecklist(item) {
            item.classList.toggle('checked');
            updateEvidenceProgress();
        }

        function updateEvidenceProgress() {
            const checked = document.querySelectorAll('#evidence-checklist .checklist-item.checked').length;
            const countEl = document.getElementById('evidence-count');
            if (countEl) countEl.textContent = checked;
        }

        // Notes
        function saveNotes() {
            const notesEl = document.getElementById('investigation-notes');
            if (notesEl) {
                state.notes = notesEl.value;
                saveState();
                alert('Notes saved!');
            }
        }

        function clearNotes() {
            if (confirm('Are you sure you want to clear all notes?')) {
                const notesEl = document.getElementById('investigation-notes');
                if (notesEl) {
                    notesEl.value = '';
                    state.notes = '';
                    saveState();
                }
            }
        }

        // Report Functions
        function addTimelineEntry() {
            const container = document.getElementById('timeline-entries');
            const count = container.children.length + 1;
            const entry = document.createElement('div');
            entry.className = 'report-field timeline-entry';
            entry.style.cssText = 'display: flex; gap: 0.5rem; align-items: center;';
            entry.innerHTML = `
                <input type="text" class="timeline-time" placeholder="Date/Time (UTC)" style="width: 180px;">
                <input type="text" class="timeline-event" placeholder="Description of event" style="flex: 1;">
            `;
            container.appendChild(entry);
        }

        function validateReport() {
            const feedback = document.getElementById('report-validation-feedback');
            let issues = [];
            
            const requiredFields = [
                { id: 'report-title', name: 'Incident Title' },
                { id: 'report-oneliner', name: 'One-Line Summary' },
                { id: 'report-severity', name: 'Severity' },
                { id: 'report-status', name: 'Status' },
                { id: 'report-impact', name: 'Impact Assessment' },
                { id: 'report-initial-access', name: 'Initial Access Vector' },
                { id: 'report-progression', name: 'Attack Progression' },
                { id: 'report-systems', name: 'Compromised Systems' },
                { id: 'report-immediate', name: 'Immediate Actions' },
                { id: 'report-analyst', name: 'Analyst Name' }
            ];
            
            requiredFields.forEach(field => {
                const el = document.getElementById(field.id);
                if (!el || !el.value.trim()) issues.push(field.name);
            });
            
            let filledTimelines = 0;
            document.querySelectorAll('.timeline-entry').forEach(entry => {
                const time = entry.querySelector('.timeline-time').value;
                const event = entry.querySelector('.timeline-event').value;
                if (time && event) filledTimelines++;
            });
            
            if (filledTimelines < 6) {
                issues.push(`Timeline (need 6 entries, have ${{filledTimelines}})`);
            }
            
            if (issues.length > 0) {
                feedback.innerHTML = `<strong>Missing sections:</strong><br>‚Ä¢ ${issues.join('<br>‚Ä¢ ')}`;
                feedback.className = 'quiz-feedback show incorrect';
            } else {
                feedback.textContent = '‚úì All required sections complete! You can now generate your report.';
                feedback.className = 'quiz-feedback show correct';
            }
            
            return issues.length === 0;
        }

        function generateReport() {
            if (!validateReport()) return;
            
            const reportData = {
                title: document.getElementById('report-title').value,
                oneliner: document.getElementById('report-oneliner').value,
                severity: document.getElementById('report-severity').value,
                status: document.getElementById('report-status').value,
                impact: document.getElementById('report-impact').value,
                initialAccess: document.getElementById('report-initial-access').value,
                progression: document.getElementById('report-progression').value,
                actor: document.getElementById('report-actor').value,
                mitre: document.getElementById('report-mitre').value,
                systems: document.getElementById('report-systems').value,
                accounts: document.getElementById('report-accounts').value,
                data: document.getElementById('report-data').value,
                iocIps: document.getElementById('report-ioc-ips').value,
                iocDomains: document.getElementById('report-ioc-domains').value,
                iocHashes: document.getElementById('report-ioc-hashes').value,
                iocPaths: document.getElementById('report-ioc-paths').value,
                immediate: document.getElementById('report-immediate').value,
                shortterm: document.getElementById('report-shortterm').value,
                longterm: document.getElementById('report-longterm').value,
                gaps: document.getElementById('report-gaps').value,
                analyst: document.getElementById('report-analyst').value,
                date: document.getElementById('report-date').value,
                notes: document.getElementById('report-notes').value,
                timeline: []
            };
            
            document.querySelectorAll('.timeline-entry').forEach(entry => {
                const time = entry.querySelector('.timeline-time').value;
                const event = entry.querySelector('.timeline-event').value;
                if (time && event) reportData.timeline.push({ time, event });
            });
            
            state.reportData = reportData;
            saveState();
            
            const preview = document.getElementById('report-preview');
            preview.innerHTML = generateReportHTML(reportData);
            document.getElementById('generated-report').style.display = 'block';
            
            completeSection(7);
            showCompletionModal();
        }

        function generateReportHTML(data) {
            let timelineHTML = data.timeline.map(t => 
                `<tr><td style="border:1px solid #ddd;padding:0.5rem;">${t.time}</td><td style="border:1px solid #ddd;padding:0.5rem;">${t.event}</td></tr>`
            ).join('');
            
            return `
                <div style="font-family:'Times New Roman',serif;line-height:1.6;">
                    <div style="text-align:center;margin-bottom:2rem;border-bottom:2px solid #dc2626;padding-bottom:1rem;">
                        <h1 style="color:#dc2626;margin:0;">SECURITY INCIDENT REPORT</h1>
                        <h2 style="margin:0.5rem 0;">${data.title}</h2>
                        <p style="color:#666;">Classification: CONFIDENTIAL | Date: ${data.date}</p>
                    </div>
                    
                    <div style="background:#fef2f2;border-left:4px solid #dc2626;padding:1rem;margin-bottom:1.5rem;">
                        <h3 style="margin:0 0 0.5rem;color:#dc2626;">Executive Summary</h3>
                        <p><strong>Severity:</strong> ${data.severity} | <strong>Status:</strong> ${data.status}</p>
                        <p><strong>Summary:</strong> ${data.oneliner}</p>
                        <p><strong>Business Impact:</strong> ${data.impact}</p>
                    </div>
                    
                    <h3 style="color:#dc2626;border-bottom:1px solid #ddd;padding-bottom:0.5rem;">1. Attack Timeline</h3>
                    <table style="width:100%;border-collapse:collapse;margin-bottom:1.5rem;">
                        <tr style="background:#f3f4f6;"><th style="border:1px solid #ddd;padding:0.5rem;text-align:left;width:30%;">Time (UTC)</th><th style="border:1px solid #ddd;padding:0.5rem;text-align:left;">Event</th></tr>
                        ${{timelineHTML}}
                    </table>
                    
                    <h3 style="color:#dc2626;border-bottom:1px solid #ddd;padding-bottom:0.5rem;">2. Technical Analysis</h3>
                    <p><strong>Initial Access:</strong><br>${data.initialAccess}</p>
                    <p><strong>Attack Progression:</strong><br>${data.progression}</p>
                    <p><strong>Threat Actor:</strong><br>${data.actor}</p>
                    <p><strong>MITRE ATT&CK:</strong><br>${data.mitre}</p>
                    
                    <h3 style="color:#dc2626;border-bottom:1px solid #ddd;padding-bottom:0.5rem;">3. Scope of Compromise</h3>
                    <p><strong>Systems:</strong><br>${data.systems}</p>
                    <p><strong>Accounts:</strong><br>${data.accounts}</p>
                    <p><strong>Data Impact:</strong><br>${data.data}</p>
                    
                    <h3 style="color:#dc2626;border-bottom:1px solid #ddd;padding-bottom:0.5rem;">4. Indicators of Compromise</h3>
                    <table style="width:100%;border-collapse:collapse;margin-bottom:1.5rem;">
                        <tr style="background:#f3f4f6;"><th style="border:1px solid #ddd;padding:0.5rem;">Type</th><th style="border:1px solid #ddd;padding:0.5rem;">Value</th></tr>
                        <tr><td style="border:1px solid #ddd;padding:0.5rem;">IP Addresses</td><td style="border:1px solid #ddd;padding:0.5rem;font-family:monospace;">${data.iocIps || 'N/A'}</td></tr>
                        <tr><td style="border:1px solid #ddd;padding:0.5rem;">Domains</td><td style="border:1px solid #ddd;padding:0.5rem;font-family:monospace;">${data.iocDomains || 'N/A'}</td></tr>
                        <tr><td style="border:1px solid #ddd;padding:0.5rem;">File Hashes</td><td style="border:1px solid #ddd;padding:0.5rem;font-family:monospace;">${data.iocHashes || 'N/A'}</td></tr>
                        <tr><td style="border:1px solid #ddd;padding:0.5rem;">File Paths</td><td style="border:1px solid #ddd;padding:0.5rem;font-family:monospace;">${data.iocPaths || 'N/A'}</td></tr>
                    </table>
                    
                    <h3 style="color:#dc2626;border-bottom:1px solid #ddd;padding-bottom:0.5rem;">5. Recommendations</h3>
                    <p><strong>Immediate (24h):</strong><br>${data.immediate}</p>
                    <p><strong>Short-Term (1 week):</strong><br>${data.shortterm}</p>
                    <p><strong>Long-Term (30 days):</strong><br>${data.longterm}</p>
                    <p><strong>Detection Gaps:</strong><br>${data.gaps}</p>
                    
                    ${data.notes ? `<h3 style="color:#dc2626;border-bottom:1px solid #ddd;padding-bottom:0.5rem;">6. Additional Notes</h3><p>${data.notes}</p>` : ''}
                    
                    <div style="margin-top:2rem;padding-top:1rem;border-top:2px solid #ddd;">
                        <p><strong>Report By:</strong> ${data.analyst}</p>
                        <p><strong>Date:</strong> ${data.date}</p>
                    </div>
                </div>
            `;
        }

        function downloadReport() {
            const reportHTML = document.getElementById('report-preview').innerHTML;
            const fullHTML = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Security Incident Report - ${state.reportData.title}</title><style>body{font-family:'Times New Roman',serif;padding:2rem;max-width:800px;margin:0 auto;}</style></head><body>${{reportHTML}}</body></html>`;
            
            const blob = new Blob([fullHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Incident_Report_${state.reportData.date}.html`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function printReport() {
            const reportContent = document.getElementById('report-preview').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`<!DOCTYPE html><html><head><title>Security Incident Report</title><style>body{font-family:'Times New Roman',serif;padding:2rem;}@media print{body{padding:0;}}</style></head><body>${{reportContent}}</body></html>`);
            printWindow.document.close();
            printWindow.print();
        }

        function showCompletionModal() {
            let totalCorrect = 0;
            let totalQuestions = 0;
            
            for (const quiz in state.quizScores) {
                totalCorrect += state.quizScores[quiz].correct;
                totalQuestions += state.quizScores[quiz].total;
            }
            
            const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
            document.getElementById('final-score').textContent = percentage + '%';
            document.getElementById('completion-modal').classList.add('show');
        }

        // Close modals on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) overlay.classList.remove('show');
            });
        });

        // Auto-save notes
        const notesInput = document.getElementById('investigation-notes');
        if (notesInput) {
            notesInput.addEventListener('input', () => {
                state.notes = notesInput.value;
                saveState();
            });
        }

        // Initialize
        loadState();
    </script></p></body></html>
