<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 9: User Account &amp; Permissions Auditor | Cybersecurity Coding Project</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #e0e0e0;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.15;
        }

        header {
            background: linear-gradient(135deg, #1a0000 0%, #330000 100%);
            border-bottom: 3px solid #cc0000;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(204, 0, 0, 0.3);
        }

        h1 {
            color: #cc0000;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(204, 0, 0, 0.5);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #999;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        .week-badge {
            display: inline-block;
            background: #cc0000;
            color: #fff;
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            margin-top: 1rem;
            font-weight: bold;
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .progress-bar {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 10px;
            height: 30px;
            margin: 2rem 0;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #cc0000 0%, #ff0000 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            background: #1a1a1a;
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid #333;
        }

        .tab-btn {
            background: #2a2a2a;
            color: #999;
            border: 2px solid #444;
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            flex: 1;
            min-width: 150px;
        }

        .tab-btn:hover {
            border-color: #cc0000;
            color: #cc0000;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: #cc0000;
            color: #fff;
            border-color: #ff0000;
            box-shadow: 0 0 15px rgba(204, 0, 0, 0.5);
        }

        .tab-content {
            display: none;
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 2rem;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #cc0000;
            margin-bottom: 1.5rem;
            font-size: 2rem;
            border-bottom: 2px solid #333;
            padding-bottom: 0.5rem;
        }

        h3 {
            color: #ff4444;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.4rem;
        }

        .learning-objective {
            background: #0a0a0a;
            border-left: 4px solid #cc0000;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
        }

        .concept-box {
            background: #2a2a2a;
            border: 2px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .code-block {
            background: #0a0a0a;
            border: 2px solid #333;
            border-left: 4px solid #cc0000;
            border-radius: 5px;
            padding: 1.5rem;
            margin: 1rem 0;
            overflow-x: auto;
            position: relative;
        }

        .code-block pre {
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .code-label {
            position: absolute;
            top: -10px;
            right: 10px;
            background: #cc0000;
            color: #fff;
            padding: 0.3rem 0.8rem;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .interactive-demo {
            background: #0a0a0a;
            border: 2px solid #cc0000;
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .demo-section {
            margin: 1.5rem 0;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            background: #1a1a1a;
            color: #00ff00;
            border: 2px solid #333;
            border-radius: 5px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: #cc0000;
            box-shadow: 0 0 10px rgba(204, 0, 0, 0.3);
        }

        button {
            background: #cc0000;
            color: #fff;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }

        button:hover {
            background: #ff0000;
            box-shadow: 0 0 15px rgba(204, 0, 0, 0.5);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .output-box {
            background: #0a0a0a;
            border: 2px solid #333;
            border-radius: 5px;
            padding: 1.5rem;
            margin-top: 1rem;
            min-height: 100px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
        }

        .success {
            color: #00ff00;
        }

        .error {
            color: #ff0000;
        }

        .warning {
            color: #ffaa00;
        }

        .info {
            color: #00aaff;
        }

        .challenge-box {
            background: linear-gradient(135deg, #1a0000 0%, #2a0000 100%);
            border: 2px solid #cc0000;
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .challenge-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .challenge-icon {
            font-size: 2rem;
        }

        .best-practices {
            background: #0a0a0a;
            border-left: 4px solid #00ff00;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
        }

        .security-tip {
            background: #1a0a00;
            border-left: 4px solid #ffaa00;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: #0a0a0a;
        }

        .data-table th {
            background: #cc0000;
            color: #fff;
            padding: 0.8rem;
            text-align: left;
            border: 1px solid #333;
        }

        .data-table td {
            padding: 0.8rem;
            border: 1px solid #333;
            color: #e0e0e0;
        }

        .data-table tr:hover {
            background: #1a1a1a;
        }

        .key-concept {
            display: inline-block;
            background: #2a0000;
            color: #ff6666;
            padding: 0.2rem 0.6rem;
            border-radius: 3px;
            font-weight: bold;
            margin: 0 0.2rem;
        }

        .sample-data-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        @media (max-width: 768px) {
            .sample-data-container {
                grid-template-columns: 1fr;
            }
        }

        .copy-btn {
            background: #444;
            color: #fff;
            padding: 0.4rem 1rem;
            font-size: 0.8rem;
            margin-top: 0.5rem;
        }

        .copy-btn:hover {
            background: #666;
        }

        ul, ol {
            margin-left: 2rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        li {
            margin: 0.5rem 0;
        }

        .ai-assistant-box {
            background: linear-gradient(135deg, #000a1a 0%, #001a2a 100%);
            border: 2px solid #0066cc;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .ai-prompt {
            background: #0a0a0a;
            border-left: 4px solid #0066cc;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
            font-style: italic;
            color: #66aaff;
        }

        .violation-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: bold;
            margin: 0.2rem;
        }

        .violation-critical {
            background: #cc0000;
            color: #fff;
        }

        .violation-high {
            background: #ff6600;
            color: #fff;
        }

        .violation-medium {
            background: #ffaa00;
            color: #000;
        }

        .violation-low {
            background: #666;
            color: #fff;
        }

        .footer {
            background: #1a1a1a;
            border-top: 3px solid #cc0000;
            padding: 2rem;
            text-align: center;
            margin-top: 4rem;
            color: #666;
        }
    </style>
</head><body><p><canvas class="matrix-bg" id="matrixCanvas"></canvas></p>
<header>
<h1>‚ö° User Account &amp; Permissions Auditor ‚ö°</h1>
<p class="subtitle">Data Joins, Sets, Anomaly Detection &amp; Compliance Reporting</p>
<div class="week-badge">WEEK 10 PROJECT</div>
</header>
<div class="container">
<div class="progress-bar">
<div class="progress-fill" id="progressBar">0%</div>
</div>
<div class="nav-tabs"><button class="tab-btn active" onclick="showTab('overview')">üìã Overview</button> <button class="tab-btn" onclick="showTab('joins')">üîó Data Joins</button> <button class="tab-btn" onclick="showTab('sets')">üìä Sets &amp; Lookups</button> <button class="tab-btn" onclick="showTab('anomalies')">üö® Anomaly Detection</button> <button class="tab-btn" onclick="showTab('reporting')">üìÑ Reporting</button> <button class="tab-btn" onclick="showTab('demo')">üíª Live Demo</button> <button class="tab-btn" onclick="showTab('challenges')">üéØ Challenges</button> <button class="tab-btn" onclick="showTab('ai-copilot')">ü§ñ AI Copilot</button></div>
<!-- OVERVIEW TAB -->
<div id="overview" class="tab-content active">
<h2>Project Overview: User Account &amp; Permissions Auditor</h2>
<div class="learning-objective">
<h3>üéØ Learning Objectives</h3>
<ul>
<li>Master data relationships through ID-based joins in Python</li>
<li>Implement set operations for efficient permission auditing</li>
<li>Develop anomaly detection rules for security compliance</li>
<li>Create comprehensive audit reports in JSON and text formats</li>
<li>Leverage AI to brainstorm additional security rules and patterns</li>
</ul>
</div>
<div class="concept-box">
<h3>üîê Real-World Context</h3>
<p>In enterprise environments, Security Operations Centers (SOCs) and compliance teams regularly audit user accounts and permissions to detect:</p>
<ul>
<li><strong>Privilege Creep:</strong> Users accumulating permissions over time beyond their role</li>
<li><strong>Orphaned Accounts:</strong> Disabled accounts still retaining active permissions</li>
<li><strong>Policy Violations:</strong> Admin access granted outside authorized departments</li>
<li><strong>Stale Accounts:</strong> Long-inactive accounts creating security vulnerabilities</li>
<li><strong>Separation of Duties:</strong> Conflicting roles that violate compliance requirements</li>
</ul>
<p style="margin-top: 1rem;">This project simulates the core functionality of enterprise Identity Access Management (IAM) auditing tools like SailPoint, Okta Advanced Server Access, or Microsoft Entra ID.</p>
</div>
<div class="concept-box">
<h3>üì¶ Project Components</h3>
<table class="data-table">
<tbody>
<tr>
<th>Component</th>
<th>Description</th>
<th>Learning Focus</th>
</tr>
<tr>
<td><strong>User Accounts Data</strong></td>
<td>JSON/CSV with user_id, username, status, department, last_login</td>
<td>Data structures, CSV/JSON parsing</td>
</tr>
<tr>
<td><strong>Role Memberships Data</strong></td>
<td>JSON/CSV mapping users to groups/roles via user_id</td>
<td>Relational data, foreign keys</td>
</tr>
<tr>
<td><strong>Join Operations</strong></td>
<td>Match users to roles using ID-based lookups</td>
<td>Dictionary-based joins, data relationships</td>
</tr>
<tr>
<td><strong>Set Operations</strong></td>
<td>Track unique users, roles, violations using Python sets</td>
<td>Set theory, efficient lookups</td>
</tr>
<tr>
<td><strong>Anomaly Detection</strong></td>
<td>Implement rules to flag policy violations</td>
<td>Conditional logic, security patterns</td>
</tr>
<tr>
<td><strong>Report Generation</strong></td>
<td>JSON violations list + text summary report</td>
<td>Output formatting, compliance documentation</td>
</tr>
</tbody>
</table>
</div>
<div class="security-tip">
<h3>üõ°Ô∏è Security Perspective</h3>
<p><strong>Why This Matters:</strong> According to the Verizon 2024 Data Breach Investigations Report, compromised credentials account for nearly 50% of breaches. Regular account auditing helps identify:</p>
<ul>
<li>Accounts that should have been deprovisioned (former employees)</li>
<li>Excessive permissions that violate least privilege principle</li>
<li>Dormant accounts vulnerable to credential stuffing attacks</li>
<li>Policy violations that create audit findings during compliance reviews</li>
</ul>
</div>
<div class="concept-box">
<h3>üóìÔ∏è Week 9 Development Timeline</h3>
<table class="data-table">
<tbody>
<tr>
<th>Day</th>
<th>Focus Area</th>
<th>Deliverable</th>
</tr>
<tr>
<td>Monday-Tuesday</td>
<td>Data parsing and joins</td>
<td>Load both datasets, implement ID-based join logic</td>
</tr>
<tr>
<td>Wednesday</td>
<td>Set operations and lookups</td>
<td>Create efficient lookup structures using dictionaries and sets</td>
</tr>
<tr>
<td>Thursday</td>
<td>Anomaly detection rules</td>
<td>Implement 3+ violation detection rules</td>
</tr>
<tr>
<td>Friday</td>
<td>Reporting and AI enhancement</td>
<td>Generate JSON + text reports, use AI to add 2+ new rules</td>
</tr>
</tbody>
</table>
</div>
</div>
<!-- DATA JOINS TAB -->
<div id="joins" class="tab-content">
<h2>üîó Data Joins: Relating Users to Permissions</h2>
<div class="concept-box">
<h3>Understanding Relational Data</h3>
<p>In databases and data analysis, a <span class="key-concept">join</span> operation combines rows from two or more tables based on a related column. In our auditing scenario:</p>
<ul>
<li><strong>User Accounts Table:</strong> Contains user profile information</li>
<li><strong>Role Memberships Table:</strong> Contains which roles each user has</li>
<li><strong>Join Key:</strong> The <code>user_id</code> field connects these datasets</li>
</ul>
</div>
<div class="sample-data-container">
<div>
<h3>Sample User Accounts Data</h3>
<div class="code-block"><span class="code-label">users.json</span>
<pre>[
  {
    "user_id": "U001",
    "username": "jdoe",
    "status": "active",
    "department": "IT",
    "last_login": "2024-11-28"
  },
  {
    "user_id": "U002",
    "username": "asmith",
    "status": "disabled",
    "department": "HR",
    "last_login": "2024-08-15"
  },
  {
    "user_id": "U003",
    "username": "bwilliams",
    "status": "active",
    "department": "Finance",
    "last_login": "2024-11-29"
  }
]</pre>
</div>
</div>
<div>
<h3>Sample Role Memberships Data</h3>
<div class="code-block"><span class="code-label">roles.json</span>
<pre>[
  {
    "user_id": "U001",
    "role": "admin",
    "assigned_date": "2024-01-15"
  },
  {
    "user_id": "U002",
    "role": "hr_manager",
    "assigned_date": "2023-06-01"
  },
  {
    "user_id": "U002",
    "role": "admin",
    "assigned_date": "2023-08-20"
  },
  {
    "user_id": "U003",
    "role": "finance_user",
    "assigned_date": "2024-02-01"
  }
]</pre>
</div>
</div>
</div>
<div class="concept-box">
<h3>Join Strategy: Dictionary-Based Lookups</h3>
<p>In Python, we implement joins using dictionaries for O(1) average lookup time:</p>
<div class="code-block"><span class="code-label">Python</span>
<pre># Step 1: Create a dictionary keyed by user_id for fast lookups
users_dict = {}
for user in users_data:
    users_dict[user['user_id']] = user

# Step 2: Join roles to users
for role_entry in roles_data:
    user_id = role_entry['user_id']
    
    # Look up the user info
    if user_id in users_dict:
        user_info = users_dict[user_id]
        
        # Now we can access both user and role data together
        print(f"User {user_info['username']} has role: {role_entry['role']}")
        print(f"Department: {user_info['department']}")
        print(f"Status: {user_info['status']}")
    else:
        print(f"Warning: Role assigned to unknown user_id: {user_id}")</pre>
</div>
</div>
<div class="best-practices">
<h3>‚úÖ Best Practices for Joins</h3>
<ul>
<li><strong>Always validate keys exist:</strong> Check <code>if user_id in users_dict</code> before accessing</li>
<li><strong>Handle missing data gracefully:</strong> Log warnings for orphaned records</li>
<li><strong>Use meaningful variable names:</strong> <code>users_dict</code> is clearer than <code>d1</code></li>
<li><strong>Consider memory vs. speed tradeoffs:</strong> Dictionaries use more memory but provide fast lookups</li>
<li><strong>Document your join logic:</strong> Explain which field links the datasets</li>
</ul>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">üéØ</span>
<h3>Challenge: Implement Multiple Join Patterns</h3>
</div>
<p>Try implementing these different join approaches:</p>
<ol>
<li><strong>Inner Join:</strong> Only include users that have roles assigned</li>
<li><strong>Left Join:</strong> Include all users, even if they have no roles (show None for roles)</li>
<li><strong>Many-to-Many:</strong> Handle users with multiple roles (create a list of roles per user)</li>
</ol>
</div>
<div class="code-block"><span class="code-label">Advanced: Grouping Roles Per User</span>
<pre># Group all roles for each user
from collections import defaultdict

user_roles = defaultdict(list)  # Automatically creates empty list for new keys

for role_entry in roles_data:
    user_id = role_entry['user_id']
    user_roles[user_id].append(role_entry['role'])

# Now we can easily check all roles for a user
for user in users_data:
    user_id = user['user_id']
    roles = user_roles[user_id]  # Returns list of roles (or empty list if none)
    print(f"{user['username']} has roles: {', '.join(roles) if roles else 'NONE'}")</pre>
</div>
</div>
<!-- SETS & LOOKUPS TAB -->
<div id="sets" class="tab-content">
<h2>üìä Sets &amp; Dictionary Lookups: Efficient Data Structures</h2>
<div class="concept-box">
<h3>Why Sets and Dictionaries Matter for Auditing</h3>
<p>When auditing thousands of user accounts, performance matters. Python's <span class="key-concept">sets</span> and <span class="key-concept">dictionaries</span> provide O(1) average-case lookups, making them ideal for:</p>
<ul>
<li>Tracking unique users, departments, or roles</li>
<li>Quickly checking if a user belongs to a prohibited group</li>
<li>Identifying duplicates or anomalies</li>
<li>Set operations: union, intersection, difference</li>
</ul>
</div>
<div class="code-block"><span class="code-label">Python Sets Basics</span>
<pre># Creating sets
active_users = {"jdoe", "bwilliams", "cjohnson"}
admin_roles = {"jdoe", "asmith"}

# Set operations
both = active_users &amp; admin_roles  # Intersection: active admins
print(f"Active admins: {{both}}")  # {'jdoe'}

all_users = active_users | admin_roles  # Union: all unique users
print(f"All users: {all_users}")

only_active = active_users - admin_roles  # Difference: active but not admin
print(f"Active non-admins: {only_active}")

# Fast membership testing (O(1) average case)
if "jdoe" in active_users:
    print("jdoe is active")  # Much faster than checking a list!</pre>
</div>
<div class="concept-box">
<h3>Practical Auditing Use Cases</h3>
<h4>Use Case 1: Finding Disabled Users with Active Roles</h4>
<div class="code-block"><span class="code-label">Python</span>
<pre># Build sets from our data
disabled_users = set()
for user in users_data:
    if user['status'] == 'disabled':
        disabled_users.add(user['user_id'])

users_with_roles = set()
for role_entry in roles_data:
    users_with_roles.add(role_entry['user_id'])

# Find the intersection: disabled users who still have roles
violations = disabled_users &amp; users_with_roles
print(f"üö® {len(violations)} disabled users still have active roles!")
print(f"User IDs: {{violations}}")</pre>
</div>
<h4>Use Case 2: Authorized Admin Departments</h4>
<div class="code-block"><span class="code-label">Python</span>
<pre># Define which departments can have admin access
AUTHORIZED_ADMIN_DEPTS = {"IT", "Security", "Engineering"}

# Find violations
for role_entry in roles_data:
    if role_entry['role'] == 'admin':
        user_id = role_entry['user_id']
        user_info = users_dict[user_id]
        
        if user_info['department'] not in AUTHORIZED_ADMIN_DEPTS:
            print(f"‚ö†Ô∏è  {user_info['username']} (dept: {user_info['department']}) has admin role!")
            violations.append({
                'user_id': user_id,
                'username': user_info['username'],
                'violation': 'Unauthorized admin access',
                'department': user_info['department']
            })</pre>
</div>
</div>
<div class="best-practices">
<h3>‚úÖ Dictionary Strategies for Complex Lookups</h3>
<p>Beyond simple joins, dictionaries enable powerful patterns:</p>
<div class="code-block"><span class="code-label">Pattern 1: Nested Dictionaries</span>
<pre># Organize data by multiple dimensions
users_by_dept = {}
for user in users_data:
    dept = user['department']
    if dept not in users_by_dept:
        users_by_dept[dept] = []
    users_by_dept[dept].append(user)

# Now quickly get all IT users
it_users = users_by_dept.get('IT', [])
print(f"IT department has {len(it_users)} users")</pre>
</div>
<div class="code-block"><span class="code-label">Pattern 2: Dictionary Comprehensions</span>
<pre># Create lookup dictionaries in one line
users_by_id = {u['user_id']: u for u in users_data}
users_by_name = {u['username']: u for u in users_data}

# Quick lookups by different keys
user1 = users_by_id['U001']
user2 = users_by_name['jdoe']  # Same user, different lookup method</pre>
</div>
<div class="code-block"><span class="code-label">Pattern 3: defaultdict for Aggregation</span>
<pre>from collections import defaultdict

# Count roles per department
dept_role_counts = defaultdict(int)

for role_entry in roles_data:
    user_id = role_entry['user_id']
    dept = users_dict[user_id]['department']
    dept_role_counts[dept] += 1

for dept, count in dept_role_counts.items():
    print(f"{{dept}}: {{count}} role assignments")</pre>
</div>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">üéØ</span>
<h3>Challenge: Set-Based Anomaly Detection</h3>
</div>
<p>Use sets to identify these scenarios:</p>
<ol>
<li><strong>Orphaned Roles:</strong> user_ids in roles_data that don't exist in users_data</li>
<li><strong>Role Conflicts:</strong> Users with both 'auditor' and 'admin' roles (separation of duties)</li>
<li><strong>Department Coverage:</strong> Which departments have zero admin users?</li>
</ol>
<p style="margin-top: 1rem;"><em>Hint: Use set difference, intersection, and complement operations!</em></p>
</div>
<div class="security-tip">
<h3>üõ°Ô∏è Performance in Production</h3>
<p>In real SOC environments processing millions of records:</p>
<ul>
<li><strong>Sets beat lists for membership testing:</strong> O(1) vs O(n) for <code>if x in collection</code></li>
<li><strong>Dictionaries enable instant lookups:</strong> Critical when joining large datasets</li>
<li><strong>Memory is the tradeoff:</strong> Hash tables use more RAM than simple lists</li>
<li><strong>Pre-compute common lookups:</strong> Build your dictionaries once, use them many times</li>
</ul>
</div>
</div>
<!-- ANOMALY DETECTION TAB -->
<div id="anomalies" class="tab-content">
<h2>üö® Anomaly Detection: Security Policy Rules</h2>
<div class="concept-box">
<h3>What is Anomaly Detection in IAM?</h3>
<p><span class="key-concept">Anomaly detection</span> identifies deviations from expected patterns or policy violations. In user account auditing, we define rules that flag suspicious or non-compliant conditions.</p>
<p style="margin-top: 1rem;">Common categories:</p>
<ul>
<li><strong>Status Anomalies:</strong> Disabled accounts with active permissions</li>
<li><strong>Policy Violations:</strong> Roles assigned to unauthorized departments</li>
<li><strong>Temporal Anomalies:</strong> Stale accounts (no login for X days)</li>
<li><strong>Permission Anomalies:</strong> Excessive privileges or conflicting roles</li>
<li><strong>Behavioral Anomalies:</strong> Unusual login patterns or access times (advanced)</li>
</ul>
</div>
<div class="code-block"><span class="code-label">Rule 1: Disabled Users with Active Roles</span>
<pre>def check_disabled_with_roles(users_dict, roles_data):
    """Detect disabled users who still have role assignments."""
    violations = []
    
    # Build set of user_ids who have roles
    users_with_roles = {role['user_id'] for role in roles_data}
    
    for user_id, user in users_dict.items():
        if user['status'] == 'disabled' and user_id in users_with_roles:
            # Find all roles this disabled user has
            user_roles = [r['role'] for r in roles_data if r['user_id'] == user_id]
            
            violations.append({
                'user_id': user_id,
                'username': user['username'],
                'violation_type': 'disabled_with_roles',
                'severity': 'CRITICAL',
                'details': f"Disabled account has {len(user_roles)} active role(s): {', '.join(user_roles)}",
                'roles': user_roles
            })
    
    return violations</pre>
</div>
<div class="code-block"><span class="code-label">Rule 2: Unauthorized Admin Access</span>
<pre>def check_unauthorized_admins(users_dict, roles_data, authorized_depts={'IT', 'Security'}):
    """Detect admin roles assigned outside authorized departments."""
    violations = []
    
    for role_entry in roles_data:
        if 'admin' in role_entry['role'].lower():  # Catches 'admin', 'sysadmin', etc.
            user_id = role_entry['user_id']
            
            if user_id in users_dict:
                user = users_dict[user_id]
                
                if user['department'] not in authorized_depts:
                    violations.append({
                        'user_id': user_id,
                        'username': user['username'],
                        'violation_type': 'unauthorized_admin',
                        'severity': 'HIGH',
                        'details': f"{user['department']} dept user has admin role: {role_entry['role']}",
                        'department': user['department'],
                        'role': role_entry['role']
                    })
    
    return violations</pre>
</div>
<div class="code-block"><span class="code-label">Rule 3: Stale Account Detection</span>
<pre>from datetime import datetime, timedelta

def check_stale_accounts(users_dict, stale_days=90):
    """Detect accounts with no login in X days."""
    violations = []
    cutoff_date = datetime.now() - timedelta(days=stale_days)
    
    for user_id, user in users_dict.items():
        if user['status'] != 'active':
            continue  # Only check active accounts
        
        last_login_str = user.get('last_login')
        if not last_login_str:
            # No login date recorded - treat as stale
            violations.append({
                'user_id': user_id,
                'username': user['username'],
                'violation_type': 'stale_account',
                'severity': 'MEDIUM',
                'details': f"Active account with no recorded login date",
                'last_login': None
            })
        else:
            last_login = datetime.strptime(last_login_str, '%Y-%m-%d')
            
            if last_login &lt; cutoff_date:
                days_since = (datetime.now() - last_login).days
                violations.append({
                    'user_id': user_id,
                    'username': user['username'],
                    'violation_type': 'stale_account',
                    'severity': 'MEDIUM',
                    'details': f"No login for {days_since} days (last: {last_login_str})",
                    'last_login': last_login_str,
                    'days_inactive': days_since
                })
    
    return violations</pre>
</div>
<div class="concept-box">
<h3>Advanced Rules You Can Implement</h3>
<table class="data-table">
<tbody>
<tr>
<th>Rule Name</th>
<th>Description</th>
<th>Severity</th>
<th>Implementation Hint</th>
</tr>
<tr>
<td>Conflicting Roles</td>
<td>User has both 'auditor' and 'admin' (separation of duties)</td>
<td><span class="violation-badge violation-critical">CRITICAL</span></td>
<td>Build set of roles per user, check for conflicts</td>
</tr>
<tr>
<td>Excessive Roles</td>
<td>User has more than N roles (e.g., 5+)</td>
<td><span class="violation-badge violation-medium">MEDIUM</span></td>
<td>Count roles per user_id, flag if &gt; threshold</td>
</tr>
<tr>
<td>Service Account Without Flag</td>
<td>Username starts with 'svc_' but not marked as service account</td>
<td><span class="violation-badge violation-low">LOW</span></td>
<td>Pattern matching on username, check account_type field</td>
</tr>
<tr>
<td>Orphaned Roles</td>
<td>Role assigned to user_id that doesn't exist</td>
<td><span class="violation-badge violation-high">HIGH</span></td>
<td>Set difference: roles user_ids - users user_ids</td>
</tr>
<tr>
<td>Same-Day Multi-Role</td>
<td>Multiple roles assigned on same date (bulk provisioning error?)</td>
<td><span class="violation-badge violation-low">LOW</span></td>
<td>Group by user_id + assigned_date, count &gt; 1</td>
</tr>
</tbody>
</table>
</div>
<div class="best-practices">
<h3>‚úÖ Best Practices for Rule Implementation</h3>
<ul>
<li><strong>Use consistent violation structure:</strong> Always include user_id, username, violation_type, severity, details</li>
<li><strong>Assign severity levels:</strong> CRITICAL, HIGH, MEDIUM, LOW for prioritization</li>
<li><strong>Make rules configurable:</strong> Pass thresholds as parameters (e.g., stale_days=90)</li>
<li><strong>Log raw data in violations:</strong> Include original values for investigation</li>
<li><strong>Document your assumptions:</strong> What defines "admin"? What departments are authorized?</li>
<li><strong>Test with edge cases:</strong> Missing fields, null values, empty strings</li>
</ul>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">üéØ</span>
<h3>Challenge: Create a Custom Rule</h3>
</div>
<p>Design and implement your own anomaly detection rule. Ideas:</p>
<ul>
<li><strong>Weekend Warriors:</strong> Users who only log in on weekends (unusual pattern)</li>
<li><strong>Ghost Departments:</strong> Departments mentioned in user data but not in approved list</li>
<li><strong>Role Hoarding:</strong> Users with more roles than their department average</li>
<li><strong>Temporal Inconsistency:</strong> Users with assigned_date before hire_date</li>
</ul>
<p style="margin-top: 1rem;">Test your rule with sample data and document what it detects!</p>
</div>
<div class="security-tip">
<h3>üõ°Ô∏è Real-World Anomaly Detection</h3>
<p>In production SOCs, anomaly detection combines:</p>
<ul>
<li><strong>Rule-Based Detection:</strong> What we're implementing (deterministic, explainable)</li>
<li><strong>Statistical Baselines:</strong> Flagging deviations from normal user behavior patterns</li>
<li><strong>Machine Learning:</strong> UEBA (User and Entity Behavior Analytics) tools like Exabeam</li>
<li><strong>Threat Intelligence:</strong> Correlating with known attack patterns and IOCs</li>
</ul>
<p style="margin-top: 1rem;">Our rule-based approach forms the foundation that ML models build upon.</p>
</div>
</div>
<!-- REPORTING TAB -->
<div id="reporting" class="tab-content">
<h2>üìÑ Compliance Reporting: JSON &amp; Text Outputs</h2>
<div class="concept-box">
<h3>Why Two Report Formats?</h3>
<p>Security audits require different outputs for different audiences:</p>
<ul>
<li><strong>JSON Report:</strong> Machine-readable, parseable, for integration with SIEM/SOAR platforms</li>
<li><strong>Text Report:</strong> Human-readable summary for executives, auditors, and stakeholders</li>
</ul>
</div>
<div class="code-block"><span class="code-label">JSON Report Structure</span>
<pre>import json
from datetime import datetime

def generate_json_report(all_violations, users_dict, roles_data):
    """Generate machine-readable JSON audit report."""
    
    # Organize violations by user
    violations_by_user = {}
    for violation in all_violations:
        user_id = violation['user_id']
        if user_id not in violations_by_user:
            violations_by_user[user_id] = []
        violations_by_user[user_id].append(violation)
    
    # Build comprehensive report
    report = {
        'audit_metadata': {
            'timestamp': datetime.now().isoformat(),
            'total_users_audited': len(users_dict),
            'total_role_assignments': len(roles_data),
            'total_violations': len(all_violations),
            'auditor': 'Automated IAM Audit System v1.0'
        },
        'violation_summary': {
            'by_severity': {
                'CRITICAL': len([v for v in all_violations if v['severity'] == 'CRITICAL']),
                'HIGH': len([v for v in all_violations if v['severity'] == 'HIGH']),
                'MEDIUM': len([v for v in all_violations if v['severity'] == 'MEDIUM']),
                'LOW': len([v for v in all_violations if v['severity'] == 'LOW'])
            },
            'by_type': {}
        },
        'violations_by_user': violations_by_user,
        'all_violations': all_violations
    }
    
    # Count by violation type
    for violation in all_violations:
        vtype = violation['violation_type']
        report['violation_summary']['by_type'][vtype] = \
            report['violation_summary']['by_type'].get(vtype, 0) + 1
    
    return report

# Save to file
with open('audit_report.json', 'w') as f:
    json.dump(report, f, indent=2)
print("‚úÖ JSON report saved to audit_report.json")</pre>
</div>
<div class="code-block"><span class="code-label">Sample JSON Output</span>
<pre>{
  "audit_metadata": {
    "timestamp": "2024-11-30T14:32:15.123456",
    "total_users_audited": 150,
    "total_role_assignments": 487,
    "total_violations": 23,
    "auditor": "Automated IAM Audit System v1.0"
  },
  "violation_summary": {
    "by_severity": {
      "CRITICAL": 5,
      "HIGH": 8,
      "MEDIUM": 7,
      "LOW": 3
    },
    "by_type": {
      "disabled_with_roles": 5,
      "unauthorized_admin": 8,
      "stale_account": 7,
      "conflicting_roles": 3
    }
  },
  "violations_by_user": {
    "U002": [
      {
        "user_id": "U002",
        "username": "asmith",
        "violation_type": "disabled_with_roles",
        "severity": "CRITICAL",
        "details": "Disabled account has 2 active role(s): hr_manager, admin",
        "roles": ["hr_manager", "admin"]
      }
    ]
  }
}</pre>
</div>
<div class="code-block"><span class="code-label">Text Report Generation</span>
<pre>def generate_text_report(all_violations, users_dict, roles_data):
    """Generate human-readable text audit report."""
    
    report_lines = []
    report_lines.append("=" * 80)
    report_lines.append("USER ACCOUNT &amp; PERMISSIONS AUDIT REPORT")
    report_lines.append("=" * 80)
    report_lines.append(f"Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    report_lines.append(f"Auditor: Automated IAM Audit System v1.0")
    report_lines.append("")
    
    # Executive Summary
    report_lines.append("EXECUTIVE SUMMARY")
    report_lines.append("-" * 80)
    report_lines.append(f"Total Users Audited: {len(users_dict)}")
    report_lines.append(f"Total Role Assignments: {len(roles_data)}")
    report_lines.append(f"Total Violations Found: {len(all_violations)}")
    report_lines.append("")
    
    # Severity Breakdown
    severity_counts = {}
    for v in all_violations:
        sev = v['severity']
        severity_counts[sev] = severity_counts.get(sev, 0) + 1
    
    report_lines.append("VIOLATIONS BY SEVERITY")
    report_lines.append("-" * 80)
    for severity in ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW']:
        count = severity_counts.get(severity, 0)
        bar = "‚ñà" * count
        report_lines.append(f"{severity:12s} [{count:3d}] {{bar}}")
    report_lines.append("")
    
    # Type Breakdown
    type_counts = {}
    for v in all_violations:
        vtype = v['violation_type']
        type_counts[vtype] = type_counts.get(vtype, 0) + 1
    
    report_lines.append("VIOLATIONS BY TYPE")
    report_lines.append("-" * 80)
    for vtype, count in sorted(type_counts.items(), key=lambda x: -x[1]):
        report_lines.append(f"{vtype:30s} {count:3d}")
    report_lines.append("")
    
    # Detailed Violations
    report_lines.append("DETAILED VIOLATIONS")
    report_lines.append("=" * 80)
    
    # Group by severity for prioritization
    for severity in ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW']:
        severity_violations = [v for v in all_violations if v['severity'] == severity]
        
        if severity_violations:
            report_lines.append(f"\n{{severity}} SEVERITY ({len(severity_violations)} issues)")
            report_lines.append("-" * 80)
            
            for i, violation in enumerate(severity_violations, 1):
                report_lines.append(f"\n{{i}}. User: {violation['username']} (ID: {violation['user_id']})")
                report_lines.append(f"   Type: {violation['violation_type']}")
                report_lines.append(f"   Details: {violation['details']}")
    
    report_lines.append("\n" + "=" * 80)
    report_lines.append("END OF REPORT")
    report_lines.append("=" * 80)
    
    return "\n".join(report_lines)

# Save to file
report_text = generate_text_report(all_violations, users_dict, roles_data)
with open('audit_report.txt', 'w') as f:
    f.write(report_text)
print("‚úÖ Text report saved to audit_report.txt")</pre>
</div>
<div class="concept-box">
<h3>Sample Text Report Output</h3>
<div class="code-block">
<pre>================================================================================
USER ACCOUNT &amp; PERMISSIONS AUDIT REPORT
================================================================================
Generated: 2024-11-30 14:32:15
Auditor: Automated IAM Audit System v1.0

EXECUTIVE SUMMARY
--------------------------------------------------------------------------------
Total Users Audited: 150
Total Role Assignments: 487
Total Violations Found: 23

VIOLATIONS BY SEVERITY
--------------------------------------------------------------------------------
CRITICAL     [  5] ‚ñà‚ñà‚ñà‚ñà‚ñà
HIGH         [  8] ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
MEDIUM       [  7] ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
LOW          [  3] ‚ñà‚ñà‚ñà

VIOLATIONS BY TYPE
--------------------------------------------------------------------------------
unauthorized_admin                  8
stale_account                       7
disabled_with_roles                 5
conflicting_roles                   3

DETAILED VIOLATIONS
================================================================================

CRITICAL SEVERITY (5 issues)
--------------------------------------------------------------------------------

1. User: asmith (ID: U002)
   Type: disabled_with_roles
   Details: Disabled account has 2 active role(s): hr_manager, admin

2. User: jthompson (ID: U015)
   Type: disabled_with_roles
   Details: Disabled account has 1 active role(s): finance_admin
   
[... additional violations ...]

================================================================================
END OF REPORT
================================================================================</pre>
</div>
</div>
<div class="best-practices">
<h3>‚úÖ Reporting Best Practices</h3>
<ul>
<li><strong>Include metadata:</strong> Timestamp, auditor version, scope of audit</li>
<li><strong>Prioritize by severity:</strong> Show CRITICAL issues first in text reports</li>
<li><strong>Provide context:</strong> Include both counts and details for violations</li>
<li><strong>Make it actionable:</strong> List specific users and remediation steps</li>
<li><strong>Use consistent formatting:</strong> JSON follows schema, text has clear sections</li>
<li><strong>Support automation:</strong> JSON enables parsing by ticketing systems (Jira, ServiceNow)</li>
</ul>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">üéØ</span>
<h3>Challenge: Enhanced Reporting</h3>
</div>
<p>Add these features to your reports:</p>
<ol>
<li><strong>CSV Export:</strong> Generate violations.csv for Excel analysis</li>
<li><strong>Remediation Recommendations:</strong> Suggest specific actions for each violation type</li>
<li><strong>Trend Analysis:</strong> If you have historical data, show violations over time</li>
<li><strong>Department Breakdown:</strong> Which departments have the most violations?</li>
</ol>
</div>
<div class="security-tip">
<h3>üõ°Ô∏è Compliance Documentation</h3>
<p>Audit reports support compliance frameworks:</p>
<ul>
<li><strong>SOC 2:</strong> Access control reviews (CC6.1, CC6.2)</li>
<li><strong>ISO 27001:</strong> User access management (A.9.2)</li>
<li><strong>PCI-DSS:</strong> Quarterly user access reviews (Req 8.1.4)</li>
<li><strong>NIST 800-53:</strong> Account management (AC-2)</li>
</ul>
<p style="margin-top: 1rem;">Your reports become evidence for auditors that you're monitoring access controls.</p>
</div>
</div>
<!-- LIVE DEMO TAB -->
<div id="demo" class="tab-content">
<h2>üíª Live Interactive Demo</h2>
<div class="interactive-demo">
<h3>Test the Auditor with Sample Data</h3>
<p>Paste JSON data for users and roles, then run the audit to see violations detected in real-time.</p>
<div class="demo-section">
<h4>User Accounts Data (JSON)</h4>
<textarea id="usersInput" placeholder="[{&quot;user_id&quot;: &quot;U001&quot;, &quot;username&quot;: &quot;jdoe&quot;, &quot;status&quot;: &quot;active&quot;, &quot;department&quot;: &quot;IT&quot;, &quot;last_login&quot;: &quot;2024-11-28&quot;}, ...]"></textarea> <button class="copy-btn" onclick="loadSampleUsers()">Load Sample Users</button></div>
<div class="demo-section">
<h4>Role Memberships Data (JSON)</h4>
<textarea id="rolesInput" placeholder="[{&quot;user_id&quot;: &quot;U001&quot;, &quot;role&quot;: &quot;admin&quot;, &quot;assigned_date&quot;: &quot;2024-01-15&quot;}, ...]"></textarea> <button class="copy-btn" onclick="loadSampleRoles()">Load Sample Roles</button></div>
<div class="demo-section"><button onclick="runAudit()">üîç Run Audit</button> <button onclick="clearDemo()">üóëÔ∏è Clear All</button></div>
<div class="output-box" id="auditOutput">
<p class="info">Load sample data or paste your own JSON, then click "Run Audit" to see violations detected.</p>
</div>
</div>
</div>
<!-- CHALLENGES TAB -->
<div id="challenges" class="tab-content">
<h2>üéØ Week 9 Coding Challenges</h2>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">‚≠ê</span>
<h3>Challenge 1: Basic Auditor (Required)</h3>
</div>
<p><strong>Difficulty:</strong> Intermediate | <strong>Time:</strong> 2-3 hours</p>
<p><strong>Objective:</strong> Build a Python script that implements the core auditing functionality.</p>
<h4>Requirements:</h4>
<ul>
<li>Load user accounts from JSON/CSV file</li>
<li>Load role memberships from separate JSON/CSV file</li>
<li>Implement ID-based join using dictionaries</li>
<li>Detect at least 3 violation types:
<ul>
<li>Disabled users with active roles</li>
<li>Unauthorized admin access (outside IT/Security depts)</li>
<li>Stale accounts (no login in 90+ days)</li>
</ul>
</li>
<li>Generate both JSON and text reports</li>
</ul>
<h4>Starter Code Structure:</h4>
<div class="code-block">
<pre>import json
from datetime import datetime, timedelta

# Load data
def load_json(filename):
    with open(filename, 'r') as f:
        return json.load(f)

users_data = load_json('users.json')
roles_data = load_json('roles.json')

# Build lookup dictionary
users_dict = {u['user_id']: u for u in users_data}

# Your violation detection functions here
def check_disabled_with_roles(users_dict, roles_data):
    # TODO: Implement
    pass

# Run all checks
all_violations = []
all_violations.extend(check_disabled_with_roles(users_dict, roles_data))
# Add more checks...

# Generate reports
# TODO: Implement reporting functions</pre>
</div>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">‚≠ê‚≠ê</span>
<h3>Challenge 2: Advanced Anomaly Rules (Intermediate)</h3>
</div>
<p><strong>Difficulty:</strong> Advanced | <strong>Time:</strong> 2-3 hours</p>
<p><strong>Objective:</strong> Implement sophisticated detection rules using sets and advanced Python.</p>
<h4>Implement These Rules:</h4>
<ol>
<li><strong>Conflicting Roles:</strong> Users with both 'auditor' and 'admin' roles (separation of duties violation)</li>
<li><strong>Excessive Permissions:</strong> Users with more than 5 roles</li>
<li><strong>Orphaned Roles:</strong> Role assignments for user_ids that don't exist in users data</li>
<li><strong>Department Anomalies:</strong> Users in departments not in approved list</li>
<li><strong>Service Account Check:</strong> Usernames starting with 'svc_' without service_account flag</li>
</ol>
<h4>Bonus:</h4>
<ul>
<li>Create configurable severity levels based on role combinations</li>
<li>Implement a "risk score" for each user based on total violations</li>
<li>Add time-based analysis (roles assigned outside business hours?)</li>
</ul>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">‚≠ê‚≠ê‚≠ê</span>
<h3>Challenge 3: AI-Enhanced Auditor (Advanced)</h3>
</div>
<p><strong>Difficulty:</strong> Expert | <strong>Time:</strong> 3-4 hours</p>
<p><strong>Objective:</strong> Use GitHub Copilot or ChatGPT to brainstorm and implement novel anomaly detection rules.</p>
<h4>AI-Assisted Tasks:</h4>
<ol>
<li><strong>Brainstorm New Rules:</strong> Ask AI: "What are 10 additional security anomalies to detect in user account data?"</li>
<li><strong>Alternative Join Patterns:</strong> Ask AI: "Show me 3 different ways to join user and role data in Python"</li>
<li><strong>Performance Optimization:</strong> Ask AI: "How can I optimize this code for 100,000 users?"</li>
<li><strong>Statistical Analysis:</strong> Ask AI: "How would I detect outliers in login frequency or role counts?"</li>
</ol>
<h4>Implementation:</h4>
<ul>
<li>Implement at least 2 AI-suggested rules</li>
<li>Document which ideas came from AI vs your own design</li>
<li>Critically evaluate AI suggestions (do they make security sense?)</li>
<li>Refine AI code to match your coding standards</li>
</ul>
<h4>Reflection Questions:</h4>
<ul>
<li>Which AI suggestions were most useful? Least useful?</li>
<li>Did AI suggest rules you wouldn't have thought of?</li>
<li>How did you validate AI-generated code for correctness?</li>
</ul>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">üèÜ</span>
<h3>Bonus Challenge: Web Dashboard</h3>
</div>
<p><strong>Difficulty:</strong> Expert | <strong>Time:</strong> 4-6 hours</p>
<p><strong>Objective:</strong> Create an HTML dashboard to visualize audit results.</p>
<h4>Features:</h4>
<ul>
<li>Upload JSON files (users and roles) via browser</li>
<li>Display violations in sortable/filterable table</li>
<li>Show charts: violations by severity, by department, by type</li>
<li>Click user to see all their violations and role details</li>
<li>Export filtered results as CSV</li>
</ul>
<p><em>Hint: Use this week's HTML as a starting point, add file input handlers and Chart.js for visualization!</em></p>
</div>
</div>
<!-- AI COPILOT TAB -->
<div id="ai-copilot" class="tab-content">
<h2>ü§ñ AI Copilot Integration Guide</h2>
<div class="ai-assistant-box">
<h3>Using AI to Enhance Your Auditor</h3>
<p>This week emphasizes <strong>AI-assisted development</strong>. GitHub Copilot, ChatGPT, and Claude can help you brainstorm rules, optimize code, and explore alternative approaches.</p>
</div>
<div class="concept-box">
<h3>Strategy 1: Brainstorming Anomaly Rules</h3>
<p>AI excels at generating creative ideas for detection rules you might not think of.</p>
<div class="ai-prompt"><strong>Prompt Example:</strong><br>"I'm building a user account auditor for cybersecurity. I have data on user accounts (status, department, last_login) and role assignments. I've already implemented rules for:
<ul>
<li>Disabled users with active roles</li>
<li>Unauthorized admin access by department</li>
<li>Stale accounts (90+ days no login)</li>
</ul>
What are 10 additional security anomalies I should detect?"</div>
<h4>Sample AI Response (You Should Try This!):</h4>
<div class="code-block">
<pre>Here are 10 additional anomaly detection rules:

1. **Conflicting Roles**: Users with both 'auditor' and 'admin' roles
2. **Excessive Permissions**: Users with &gt;5 roles (privilege creep)
3. **Orphaned Roles**: Role assignments for non-existent user_ids
4. **Temporal Anomalies**: Roles assigned before hire_date
5. **Service Account Detection**: Usernames like 'svc_*' without proper flag
6. **Bulk Assignment Anomalies**: &gt;10 roles assigned same day (script error?)
7. **Department Inconsistencies**: Users in unapproved departments
8. **Login Frequency Outliers**: Users who never log in but are active
9. **Privilege Escalation Pattern**: User gained admin within 30 days of hire
10. **Geographic Anomalies**: Logins from unusual locations (if geo data available)</pre>
</div>
<h4>Critical Evaluation:</h4>
<p>Don't blindly implement AI suggestions! Ask yourself:</p>
<ul>
<li>‚úÖ Does this rule make security sense?</li>
<li>‚úÖ Do I have the data needed to implement it?</li>
<li>‚úÖ What's the false positive rate likely to be?</li>
<li>‚úÖ How would a SOC analyst action this alert?</li>
</ul>
</div>
<div class="concept-box">
<h3>Strategy 2: Alternative Implementation Patterns</h3>
<p>Ask AI to show you different approaches, then choose the best one.</p>
<div class="ai-prompt"><strong>Prompt Example:</strong><br>"Show me 3 different ways to join user account data with role membership data in Python. For each approach, explain the tradeoffs in terms of performance, memory usage, and code readability."</div>
<h4>What You Might Learn:</h4>
<ul>
<li><strong>Dictionary-based join</strong> (what we teach) - fast lookup, more memory</li>
<li><strong>Pandas merge</strong> - SQL-like syntax, overkill for small datasets</li>
<li><strong>Nested loops</strong> - simple but O(n¬≤) performance</li>
</ul>
<p style="margin-top: 1rem;">Your job: Understand the tradeoffs and pick the right tool for your use case!</p>
</div>
<div class="concept-box">
<h3>Strategy 3: Code Optimization</h3>
<p>Use AI to identify performance bottlenecks and suggest improvements.</p>
<div class="ai-prompt"><strong>Prompt Example:</strong><br>"Here's my code that checks for disabled users with roles. It works but seems slow with 100,000 users. How can I optimize it?
<pre style="margin-top: 0.5rem;">[paste your code here]</pre>
</div>
<h4>AI Might Suggest:</h4>
<ul>
<li>Build user lookup dictionary once, reuse across all checks</li>
<li>Use set operations instead of list comprehensions</li>
<li>Pre-filter data (only check active users for stale accounts)</li>
<li>Use generators for memory efficiency with large datasets</li>
</ul>
</div>
<div class="best-practices">
<h3>‚úÖ Best Practices for AI-Assisted Coding</h3>
<ul>
<li><strong>Start with specific context:</strong> Give AI your data structure and existing rules</li>
<li><strong>Ask for explanations:</strong> Don't just copy code - ask "why does this work?"</li>
<li><strong>Request multiple options:</strong> "Show me 3 ways..." forces comparison</li>
<li><strong>Test everything:</strong> AI can generate plausible-looking but incorrect code</li>
<li><strong>Refine iteratively:</strong> "That's good, but make it more secure by..."</li>
<li><strong>Document AI usage:</strong> Note which parts came from AI for your reflection</li>
</ul>
</div>
<div class="challenge-box">
<div class="challenge-header"><span class="challenge-icon">ü§ñ</span>
<h3>AI Copilot Exercises</h3>
</div>
<h4>Exercise 1: Rule Brainstorming</h4>
<ol>
<li>Ask AI for 10 new anomaly detection rules</li>
<li>Categorize each as: Definitely Useful / Maybe Useful / Not Applicable</li>
<li>Implement your top 3 "Definitely Useful" rules</li>
</ol>
<h4>Exercise 2: Code Review with AI</h4>
<ol>
<li>Write your audit code</li>
<li>Ask AI: "Review this code for security issues and performance problems"</li>
<li>Evaluate the suggestions - are they valid concerns?</li>
<li>Implement the improvements that make sense</li>
</ol>
<h4>Exercise 3: Documentation Generation</h4>
<ol>
<li>Give AI your final code</li>
<li>Ask: "Generate comprehensive docstrings for all functions"</li>
<li>Review and edit the docstrings for accuracy</li>
</ol>
</div>
<div class="security-tip">
<h3>‚ö†Ô∏è AI Limitations to Remember</h3>
<ul>
<li><strong>Context Window:</strong> AI may not remember earlier parts of long conversations</li>
<li><strong>Hallucinations:</strong> AI can confidently suggest non-existent libraries or functions</li>
<li><strong>Outdated Info:</strong> Training data has a cutoff date; newer security practices may not be included</li>
<li><strong>No Security Judgment:</strong> AI doesn't truly understand threat models or risk</li>
<li><strong>Your Responsibility:</strong> You're accountable for the code, not the AI</li>
</ul>
<p style="margin-top: 1rem;"><strong>Bottom line:</strong> AI is a powerful co-pilot, but YOU are the pilot. Always validate, test, and think critically.</p>
</div>
</div>
</div>
<div class="footer">
<p>Week 10: User Account &amp; Permissions Auditor | Cybersecurity Programming Course</p>
<p style="margin-top: 0.5rem;">Master data joins, sets, and anomaly detection for real-world security auditing</p>
</div>
<p><script>
        // Matrix rain effect
        const canvas = document.getElementById('matrixCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const chars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥';
        const fontSize = 14;
        const columns = canvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);

        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#cc0000';
            ctx.font = fontSize + 'px monospace';

            for (let i = 0; i < drops.length; i++) {
                const text = chars[Math.floor(Math.random() * chars.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);

                if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }

        setInterval(drawMatrix, 50);

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Tab switching
        let visitedTabs = new Set(['overview']);

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            visitedTabs.add(tabName);
            updateProgress();
        }

        function updateProgress() {
            const totalTabs = 8;
            const progress = (visitedTabs.size / totalTabs) * 100;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progress + '%';
            progressBar.textContent = Math.round(progress) + '% Complete';
        }

        // Sample data
        const sampleUsers = [
            {
                "user_id": "U001",
                "username": "jdoe",
                "status": "active",
                "department": "IT",
                "last_login": "2024-11-28"
            },
            {
                "user_id": "U002",
                "username": "asmith",
                "status": "disabled",
                "department": "HR",
                "last_login": "2024-08-15"
            },
            {
                "user_id": "U003",
                "username": "bwilliams",
                "status": "active",
                "department": "Finance",
                "last_login": "2024-11-29"
            },
            {
                "user_id": "U004",
                "username": "mjohnson",
                "status": "active",
                "department": "Marketing",
                "last_login": "2024-11-25"
            },
            {
                "user_id": "U005",
                "username": "rdavis",
                "status": "active",
                "department": "IT",
                "last_login": "2024-07-10"
            }
        ];

        const sampleRoles = [
            {
                "user_id": "U001",
                "role": "admin",
                "assigned_date": "2024-01-15"
            },
            {
                "user_id": "U002",
                "role": "hr_manager",
                "assigned_date": "2023-06-01"
            },
            {
                "user_id": "U002",
                "role": "admin",
                "assigned_date": "2023-08-20"
            },
            {
                "user_id": "U003",
                "role": "finance_user",
                "assigned_date": "2024-02-01"
            },
            {
                "user_id": "U004",
                "role": "admin",
                "assigned_date": "2024-03-10"
            },
            {
                "user_id": "U005",
                "role": "sysadmin",
                "assigned_date": "2024-01-05"
            }
        ];

        function loadSampleUsers() {
            document.getElementById('usersInput').value = JSON.stringify(sampleUsers, null, 2);
        }

        function loadSampleRoles() {
            document.getElementById('rolesInput').value = JSON.stringify(sampleRoles, null, 2);
        }

        function runAudit() {
            const output = document.getElementById('auditOutput');
            output.innerHTML = '<p class="info">üîç Running audit...</p>';

            try {
                const usersText = document.getElementById('usersInput').value;
                const rolesText = document.getElementById('rolesInput').value;

                if (!usersText || !rolesText) {
                    output.innerHTML = '<p class="error">‚ùå Please load or paste both user and role data.</p>';
                    return;
                }

                const users = JSON.parse(usersText);
                const roles = JSON.parse(rolesText);

                // Build users dictionary
                const usersDict = {};
                users.forEach(user => {
                    usersDict[user.user_id] = user;
                });

                const violations = [];
                const authorizedAdminDepts = new Set(['IT', 'Security']);

                // Rule 1: Disabled users with roles
                const usersWithRoles = new Set(roles.map(r => r.user_id));
                users.forEach(user => {
                    if (user.status === 'disabled' && usersWithRoles.has(user.user_id)) {
                        const userRoles = roles.filter(r => r.user_id === user.user_id).map(r => r.role);
                        violations.push({
                            user_id: user.user_id,
                            username: user.username,
                            violation_type: 'disabled_with_roles',
                            severity: 'CRITICAL',
                            details: `Disabled account has ${userRoles.length} active role(s): ${userRoles.join(', ')}`
                        });
                    }
                });

                // Rule 2: Unauthorized admin access
                roles.forEach(roleEntry => {
                    if (roleEntry.role.toLowerCase().includes('admin')) {
                        const user = usersDict[roleEntry.user_id];
                        if (user && !authorizedAdminDepts.has(user.department)) {
                            violations.push({
                                user_id: roleEntry.user_id,
                                username: user.username,
                                violation_type: 'unauthorized_admin',
                                severity: 'HIGH',
                                details: `${user.department} dept user has admin role: ${roleEntry.role}`
                            });
                        }
                    }
                });

                // Rule 3: Stale accounts (90+ days)
                const now = new Date();
                const staleThreshold = new Date(now.getTime() - (90 * 24 * 60 * 60 * 1000));
                
                users.forEach(user => {
                    if (user.status === 'active') {
                        if (!user.last_login) {
                            violations.push({
                                user_id: user.user_id,
                                username: user.username,
                                violation_type: 'stale_account',
                                severity: 'MEDIUM',
                                details: 'Active account with no recorded login date'
                            });
                        } else {
                            const lastLogin = new Date(user.last_login);
                            if (lastLogin < staleThreshold) {
                                const daysSince = Math.floor((now - lastLogin) / (1000 * 60 * 60 * 24));
                                violations.push({
                                    user_id: user.user_id,
                                    username: user.username,
                                    violation_type: 'stale_account',
                                    severity: 'MEDIUM',
                                    details: `No login for ${{daysSince}} days (last: ${user.last_login})`
                                });
                            }
                        }
                    }
                });

                // Display results
                let html = '<h3 style="color: #cc0000; margin-bottom: 1rem;">Audit Results</h3>';
                html += `<p class="info">üìä Total Users: ${users.length} | Role Assignments: ${roles.length}</p>`;
                html += `<p class="${violations.length > 0 ? 'warning' : 'success'}">üö® Violations Found: ${violations.length}</p>`;
                html += '<hr style="border-color: #333; margin: 1rem 0;">';

                if (violations.length === 0) {
                    html += '<p class="success">‚úÖ No violations detected! All accounts are compliant.</p>';
                } else {
                    // Group by severity
                    const severityOrder = ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW'];
                    severityOrder.forEach(severity => {
                        const sevViolations = violations.filter(v => v.severity === severity);
                        if (sevViolations.length > 0) {
                            const color = severity === 'CRITICAL' ? '#cc0000' : 
                                        severity === 'HIGH' ? '#ff6600' :
                                        severity === 'MEDIUM' ? '#ffaa00' : '#999';
                            html += `<h4 style="color: ${{color}}; margin-top: 1.5rem;">${{severity}} (${sevViolations.length})</h4>`;
                            sevViolations.forEach((v, i) => {
                                html += `<div style="background: #1a1a1a; padding: 1rem; margin: 0.5rem 0; border-left: 4px solid ${{color}};">`;
                                html += `<strong>${i + 1}. ${v.username}</strong> (${v.user_id})<br>`;
                                html += `Type: ${v.violation_type}<br>`;
                                html += `Details: ${v.details}`;
                                html += `</div>`;
                            });
                        }
                    });
                }

                output.innerHTML = html;

            } catch (error) {
                output.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p><p class="info">Make sure your JSON is valid.</p>`;
            }
        }

        function clearDemo() {
            document.getElementById('usersInput').value = '';
            document.getElementById('rolesInput').value = '';
            document.getElementById('auditOutput').innerHTML = '<p class="info">Load sample data or paste your own JSON, then click "Run Audit" to see violations detected.</p>';
        }

        // Initialize
        updateProgress();
    </script></p></body></html>
